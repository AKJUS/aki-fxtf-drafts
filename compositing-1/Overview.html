<!DOCTYPE html><html lang=en><head>
  <meta content="text/html; charset=utf-8" http-equiv=Content-Type>
  <title>Compositing and Blending Level 1</title>
  <link href=../default.css rel=stylesheet type=text/css>
  <link href=../csslogo.ico rel="shortcut icon" type=image/x-icon>
  <link href=https://www.w3.org/StyleSheets/TR/W3C-ED rel=stylesheet type=text/css>

  <script defer src=//test.csswg.org/harness/annotate.js#compositing-1_dev type=text/javascript></script>
<style type=text/css>
a[data-link-type=element]::before,span[data-link-type=element]::before {
  content: '<';
}
a[data-link-type=element]::after,span[data-link-type=element]::after {
  content: '>';
}
</style>

</head>
<body class=h-entry>
<div class=head>
  <p data-fill-with=logo><a class=logo href=http://www.w3.org/>
    <img alt=W3C height=48 src=https://www.w3.org/Icons/w3c_home width=72>
</a>
</p>
  <h1 class="p-name no-ref" id=title>Compositing and Blending Level 1</h1>
  <h2 class="no-num no-toc no-ref heading settled heading" id=subtitle><span class=content>Editor’s Draft,
    <span class=dt-updated><span class=value-title title=20140630>30 June 2014</span></span></span></h2>
  <div data-fill-with=spec-metadata><dl>
	<dt>This version:
	<dd><a class=u-url href=http://dev.w3.org/fxtf/compositing-1/>http://dev.w3.org/fxtf/compositing-1/</a>
	<dt>Latest version:
	<dd><a href=http://www.w3.org/TR/compositing-1/>http://www.w3.org/TR/compositing-1/</a>
	<dt>Previous Versions:
	<dd><dd><a href=http://www.w3.org/TR/2014/WD-compositing-1-20140107/ rel=previous>http://www.w3.org/TR/2014/WD-compositing-1-20140107/</a>
	<dt>Feedback:
	<dd><a href="mailto:public-fx@w3.org?subject=%5Bcompositing%5D%20feedback">public-fx@w3.org</a>
            with subject line
            “<kbd>[compositing] <var>… message topic …</var></kbd>”(<a href=http://lists.w3.org/Archives/Public/public-fx/ rel=discussion>archives</a>)
	<dt>Test Suite:
	<dd><a href=http://test.csswg.org/suites/compositing-1_dev/nightly-unstable/>http://test.csswg.org/suites/compositing-1_dev/nightly-unstable/</a>
	<dt>Editors:
	<dd><dd class="p-author h-card vcard"><a class="p-name fn u-email email" href=mailto:cabanier@adobe.com>Rik Cabanier</a> (<span class="p-org org">Adobe Systems Inc.</span>)
	<dd><dd class="p-author h-card vcard"><a class="p-name fn u-email email" href=mailto:Nikos.Andronikos@cisra.canon.com.au>Nikos Andronikos</a> (<span class="p-org org">Canon Information Systems Research Australia</span>)
</dl>
</div>
  <div data-fill-with=warning></div>
  <p class=copyright data-fill-with=copyright><a href=http://www.w3.org/Consortium/Legal/ipr-notice#Copyright>Copyright</a> © 2014 <a href=http://www.w3.org/><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href=http://www.csail.mit.edu/><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href=http://www.ercim.eu/><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href=http://www.keio.ac.jp/>Keio</a>, <a href=http://ev.buaa.edu.cn/>Beihang</a>), All Rights Reserved. W3C <a href=http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer>liability</a>, <a href=http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks>trademark</a> and <a href=http://www.w3.org/Consortium/Legal/copyright-documents>document use</a> rules apply.
</p>
  <hr title="Separator for header">
</div>

<h2 class="no-num no-toc no-ref heading settled heading" id=abstract><span class=content>Abstract</span></h2>
<p class=p-summary data-fill-with=abstract><p>Compositing describes how shapes of different elements are combined into a single image. There are various possible approaches for compositing. Previous versions of SVG and CSS used <a href=http://www.w3.org/TR/SVG11/masking.html#SimpleAlphaBlending>Simple Alpha Compositing</a>. In this model, each element is rendered into its own buffer and is then merged with its <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> using the Porter Duff <span class=css data-link-type=maybe title=source-over>source-over</span> operator. This specification will define a new compositing model that expands upon the Simple Alpha Compositing model by offering:

<ul><li>additional Porter Duff compositing operators<li>advanced blending modes which allow control of how colors mix in the areas where shapes overlap<li>compositing groups</ul>
In addition, this specification will define CSS properties for blending and group isolation and the properties of the <a href=http://www.w3.org/TR/2dcontext2/#dom-context-2d-globalcompositeoperation title="canvas 2d globalcompositeoperation">‘globalcompositeoperation’</a> attribute as defined in <a data-biblio-type=informative data-link-type=biblio href=#biblio-2dcontext2 title=biblio-2dcontext2>[2DCONTEXT2]</a>.<p></p>

<a href=http://www.w3.org/TR/CSS/>CSS</a> is a language for describing the rendering of structured documents 
(such as HTML and XML) 
on screen, on paper, in speech, etc.</p>

<h2 class="no-num no-toc no-ref heading settled heading" id=status><span class=content>Status of this document</span></h2>
<div data-fill-with=status><p>
	This is a public copy of the editors' draft. 
	It is provided for discussion only and may change at any moment. 
	Its publication here does not imply endorsement of its contents by W3C. 
	Don’t cite this document other than as work in progress.

<p>
	The (<a href=http://lists.w3.org/Archives/Public/public-fx/>archived</a>) public mailing list
	<a href="mailto:public-fx@w3.org?Subject=%5Bcompositing%5D%20PUT%20SUBJECT%20HERE">public-fx@w3.org</a> 
	(see <a href=http://www.w3.org/Mail/Request>instructions</a>) 
	is preferred for discussion of this specification. 
	When sending e-mail, 
	please put the text “compositing” in the subject, 
	preferably like this:
	“[compositing] <em>…summary of comment…</em>”

<p>
	This document was produced by the <a href=http://www.w3.org/Style/CSS/members>CSS Working Group</a> 
	(part of the <a href=http://www.w3.org/Style/>Style Activity</a>) and the <a href=http://www.w3.org/Graphics/SVG/WG/>SVG Working Group</a> (part of the
	<a href=http://www.w3.org/Graphics/>Graphics Activity</a>).

<p>
	This document was produced by groups operating under 
	the <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/>5 February 2004 W3C Patent Policy</a>. 
	W3C maintains a <a href=http://www.w3.org/2004/01/pp-impl/32061/status rel=disclosure>public list of any patent disclosures (CSS)</a>
	and a <a href=http://www.w3.org/2004/01/pp-impl/19480/status rel=disclosure>public list of any patent disclosures (SVG)</a> 
	made in connection with the deliverables of each group; 
	these pages also includes instructions for disclosing a patent. 
	An individual who has actual knowledge of a patent which the individual believes contains
	<a href=http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential>Essential Claim(s)</a> 
	must disclose the information in accordance with <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure>section 6 of the W3C Patent Policy</a>.</div>
<div data-fill-with=at-risk><p>The following features are at-risk, and may be dropped during the CR period:
<ul><li>Force <a class=property data-link-type=propdesc href=#propdef-isolation title=isolation>isolation</a> if an SVG images is linked using the <a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-img-element title=img>img</a> element.</ul></div>

<h2 class="no-num no-toc no-ref heading settled heading" id=contents><span class=content>Table of Contents</span></h2>
<div data-fill-with=table-of-contents><ul class=toc>
	<li><a href=#introduction><span class=secno>1</span> Introduction</a>
	<li><a href=#reading-this-document><span class=secno>2</span> Reading This Document</a>
		<ul class=toc>
		<li><a href=#module-interactions><span class=secno>2.1</span> Module interactions</a>
		<li><a href=#values><span class=secno>2.2</span> Values</a></ul>
	<li><a href=#csscompositingandblending><span class=secno>3</span> Specifying Blending in CSS </a>
		<ul class=toc>
		<li><a href=#compositingandblendingorder><span class=secno>3.1</span> Order of graphical operations</a>
		<li><a href=#csscompositingrules_CSS><span class=secno>3.2</span> Behavior specific to HTML</a>
		<li><a href=#csscompositingrules_SVG><span class=secno>3.3</span> Behavior specific to SVG</a>
		<li><a href=#csskeywords><span class=secno>3.4</span> CSS Properties</a>
			<ul class=toc>
			<li><a href=#mix-blend-mode><span class=secno>3.4.1</span> The <span>mix-blend-mode</span> property</a>
			<li><a href=#isolation><span class=secno>3.4.2</span> The <span>isolation</span> property</a>
			<li><a href=#background-blend-mode><span class=secno>3.4.3</span> The <span>background-blend-mode</span> property</a></ul></ul>
	<li><a href=#canvascompositingandblending><span class=secno>4</span> Specifying Compositing and Blending in Canvas 2D</a>
	<li><a href=#whatiscompositing><span class=secno>5</span> Introduction to compositing</a>
		<ul class=toc>
		<li><a href=#simplealphacompositing><span class=secno>5.1</span> Simple alpha compositing</a>
			<ul class=toc>
			<li><a href=#simplealphacompositingexamples><span class=secno>5.1.1</span> Examples of simple alpha compositing</a></ul></ul>
	<li><a href=#generalformula><span class=secno>6</span> General Formula for Compositing and Blending</a>
	<li><a href=#backdrop><span class=secno>7</span> Backdrop calculation</a>
		<ul class=toc>
		<li><a href=#backdropexamples><span class=secno>7.1</span> Examples of backdrop calculation</a></ul>
	<li><a href=#groups><span class=secno>8</span> Compositing Groups</a>
		<ul class=toc>
		<li><a href=#groupinvariance><span class=secno>8.1</span> Group invariance</a>
		<li><a href=#isolatedgroups><span class=secno>8.2</span> Isolated Groups</a>
		<li><a href=#pagebackdrop><span class=secno>8.3</span> The Page Group</a></ul>
	<li><a href=#advancedcompositing><span class=secno>9</span> Advanced compositing features</a>
		<ul class=toc>
		<li><a href=#porterduffcompositingoperators><span class=secno>9.1</span> The Porter Duff Compositing Operators</a>
			<ul class=toc>
			<li><a href=#porterduffcompositingoperators_clear><span class=secno>9.1.1</span> Clear</a>
			<li><a href=#porterduffcompositingoperators_src><span class=secno>9.1.2</span> Copy</a>
			<li><a href=#porterduffcompositingoperators_dst><span class=secno>9.1.3</span> Destination</a>
			<li><a href=#porterduffcompositingoperators_srcover><span class=secno>9.1.4</span> Source Over</a>
			<li><a href=#porterduffcompositingoperators_dstover><span class=secno>9.1.5</span> Destination Over</a>
			<li><a href=#porterduffcompositingoperators_srcin><span class=secno>9.1.6</span> Source In</a>
			<li><a href=#porterduffcompositingoperators_dstin><span class=secno>9.1.7</span> Destination In</a>
			<li><a href=#porterduffcompositingoperators_srcout><span class=secno>9.1.8</span> Source Out</a>
			<li><a href=#porterduffcompositingoperators_dstout><span class=secno>9.1.9</span> Destination Out</a>
			<li><a href=#porterduffcompositingoperators_srcatop><span class=secno>9.1.10</span> Source Atop</a>
			<li><a href=#porterduffcompositingoperators_dstatop><span class=secno>9.1.11</span> Destination Atop</a>
			<li><a href=#porterduffcompositingoperators_xor><span class=secno>9.1.12</span> XOR</a>
			<li><a href=#porterduffcompositingoperators_plus><span class=secno>9.1.13</span> Lighter</a></ul>
		<li><a href=#groupcompositing><span class=secno>9.2</span> Group compositing behavior with Porter Duff modes</a></ul>
	<li><a href=#blending><span class=secno>10</span> Blending</a>
		<ul class=toc>
		<li><a href=#blendingseparable><span class=secno>10.1</span> Separable blend modes</a>
			<ul class=toc>
			<li><a href=#blendingnormal><span class=secno>10.1.1</span> <span>normal</span> blend mode</a>
			<li><a href=#blendingmultiply><span class=secno>10.1.2</span> <span>multiply</span> blend mode</a>
			<li><a href=#blendingscreen><span class=secno>10.1.3</span> <span>screen</span> blend mode</a>
			<li><a href=#blendingoverlay><span class=secno>10.1.4</span> <span>overlay</span> blend mode</a>
			<li><a href=#blendingdarken><span class=secno>10.1.5</span> <span>darken</span> blend mode</a>
			<li><a href=#blendinglighten><span class=secno>10.1.6</span> <span>lighten</span> blend mode</a>
			<li><a href=#blendingcolordodge><span class=secno>10.1.7</span> <span>color-dodge</span> blend mode</a>
			<li><a href=#blendingcolorburn><span class=secno>10.1.8</span> <span>color-burn</span> blend mode</a>
			<li><a href=#blendinghardlight><span class=secno>10.1.9</span> <span>hard-light</span> blend mode</a>
			<li><a href=#blendingsoftlight><span class=secno>10.1.10</span> <span>soft-light</span> blend mode</a>
			<li><a href=#blendingdifference><span class=secno>10.1.11</span> <span>difference</span> blend mode</a>
			<li><a href=#blendingexclusion><span class=secno>10.1.12</span> <span>exclusion</span> blend mode</a></ul>
		<li><a href=#blendingnonseparable><span class=secno>10.2</span> Non-separable blend modes</a>
			<ul class=toc>
			<li><a href=#blendinghue><span class=secno>10.2.1</span> <span>hue</span> blend mode</a>
			<li><a href=#blendingsaturation><span class=secno>10.2.2</span> <span>saturation</span> blend mode</a>
			<li><a href=#blendingcolor><span class=secno>10.2.3</span> <span>color</span> blend mode</a>
			<li><a href=#blendingluminosity><span class=secno>10.2.4</span> <span>luminosity</span> blend mode</a></ul>
		<li><a href=#isolationblending><span class=secno>10.3</span> Effect of group isolation on blending</a></ul>
	<li><a href=#security><span class=secno>11</span> Security issues with compositing and blending</a>
	<li><a href=#changes><span class=secno>12</span> Changes</a>
	<li><a href=#conformance><span class=secno></span>  Conformance</a>
		<ul class=toc>
		<li><a href=#conventions><span class=secno></span>  Document conventions</a>
		<li><a href=#conformance-classes><span class=secno></span>  Conformance classes</a>
		<li><a href=#partial><span class=secno></span>  Partial implementations</a>
		<li><a href=#experimental><span class=secno></span>  Experimental implementations</a>
		<li><a href=#testing><span class=secno></span>  Non-experimental implementations</a></ul>
	<li><a href=#references><span class=secno></span>  References</a>
		<ul class=toc>
		<li><a href=#normative><span class=secno></span>  Normative References</a>
		<li><a href=#informative><span class=secno></span>  Informative References</a></ul>
	<li><a href=#index><span class=secno></span>  Index</a>
	<li><a href=#property-index><span class=secno></span>  Property index</a></ul></div>




<h2 class="heading settled heading" data-level=1 id=introduction><span class=secno>1 </span><span class=content>Introduction</span><a class=self-link href=#introduction></a></h2>
<p><em>This subsection is non-normative.</em><br>
The first part of this document describes the properties used to control the compositing in CSS.
The second part will describe the algorithms of Porter Duff compositing and blending.
</p>

<h2 class="heading settled heading" data-level=2 id=reading-this-document><span class=secno>2 </span><span class=content>Reading This Document</span><a class=self-link href=#reading-this-document></a></h2>

<p>Each section of this document is normative unless otherwise specified.</p>

<h3 class="heading settled heading" data-level=2.1 id=module-interactions><span class=secno>2.1 </span><span class=content>Module interactions</span><a class=self-link href=#module-interactions></a></h3>

<p>This specification defines a set of CSS properties that affect the visual rendering of elements to which
those properties are applied; these effects are applied after elements have been sized and positioned according
to the <a href=http://www.w3.org/TR/CSS2/visuren.html title="Visual formatting model">Visual formatting model</a>
from <a data-biblio-type=normative data-link-type=biblio href=#biblio-css21 title=biblio-css21>[CSS21]</a>. Some values of these properties result in the creation of a
<a href=http://www.w3.org/TR/CSS2/visuren.html#containing-block title="Visual formatting model">containing block</a>,
and/or the creation of a <a data-link-spec=css21 data-link-type=dfn href=http://dev.w3.org/csswg/css2/visuren.html#x44 title="stacking context">stacking context</a>.</p>

<p>The <a class=property data-link-type=propdesc href=#propdef-background-blend-mode title=background-blend-mode>background-blend-mode</a> property also builds upon the properties defined in the <a href=http://www.w3.org/TR/css3-background/#placement title="Backgrounds and Borders">CSS  Backgrounds and Borders</a> module <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3bg title=biblio-css3bg>[CSS3BG]</a>.</p>

<p>This specification also enhances the rules as specified in <a href=http://www.w3.org/TR/2003/REC-SVG11-20030114/masking.html#SimpleAlphaBlending title="simple alpha blending">Section 14.2 Simple alpha compositing</a> of <a data-biblio-type=informative data-link-type=biblio href=#biblio-svg11 title=biblio-svg11>[SVG11]</a> and <a href=http://www.w3.org/TR/css3-color/#alpha title="simple alpha compositing">simple alpha compositing</a> of <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3color title=biblio-css3color>[CSS3COLOR]</a>.</p>

<p>This module also extends the <a href=http://www.w3.org/TR/2dcontext2/#dom-context-2d-globalcompositeoperation title="canvas 2d globalcompositeoperation">‘globalcompositeoperation’</a> as defined in <a data-biblio-type=normative data-link-type=biblio href=#biblio-2dcontext2 title=biblio-2dcontext2>[2DCONTEXT2]</a>.</p>

<h3 class="heading settled heading" data-level=2.2 id=values><span class=secno>2.2 </span><span class=content>Values</span><a class=self-link href=#values></a></h3>

<p>This specification follows the <a href=http://www.w3.org/TR/CSS21/about.html#property-defs>CSS property
definition conventions</a> from <a href=#ref-CSS21 rel=biblioentry>[CSS21]</a>. Value types not defined in
this specification are defined in CSS Level 2 Revision 1 <a href=#ref-CSS21 rel=biblioentry>[CSS21]</a>. Other CSS
modules may expand the definitions of these value types: for example <a href=#CSS3COLOR rel=biblioentry>[CSS3COLOR]</a>,
when combined with this module, expands the definition of the &lt;color&gt;
value type as used in this specification.</p>

<p>In addition to the property-specific values listed in their definitions,
all properties defined in this specification also accept the <a href=http://www.w3.org/TR/CSS21/cascade.html#value-def-inherit>inherit</a>
keyword as their property value. For readability it has not been repeated
explicitly.</p>

<h2 class="heading settled heading" data-level=3 id=csscompositingandblending><span class=secno>3 </span><span class=content>Specifying Blending in CSS </span><a class=self-link href=#csscompositingandblending></a></h2>
<h3 class="heading settled heading" data-level=3.1 id=compositingandblendingorder><span class=secno>3.1 </span><span class=content>Order of graphical operations</span><a class=self-link href=#compositingandblendingorder></a></h3>

<p>The compositing model must follow the <a href=http://www.w3.org/TR/SVG11/render.html#Introduction>SVG compositing</a> model <a data-biblio-type=normative data-link-type=biblio href=#biblio-svg11 title=biblio-svg11>[SVG11]</a>: first any filter effect is applied, then any clipping, masking, blending and compositing.</p>

<h3 class="heading settled heading" data-level=3.2 id=csscompositingrules_CSS><span class=secno>3.2 </span><span class=content>Behavior specific to HTML</span><a class=self-link href=#csscompositingrules_CSS></a></h3>


<p>Everything in CSS that creates a <a href=http://www.w3.org/TR/CSS21/zindex.html>stacking context</a> must be considered an <a href=#isolatedgroups>‘isolated’ group</a>. HTML elements themselves should not create groups.</p>

<p>An element that has blending applied, must blend with all the underlying content of the <a data-link-spec=css21 data-link-type=dfn href=http://dev.w3.org/csswg/css2/visuren.html#x44 title="stacking context">stacking context</a> <a data-biblio-type=normative data-link-type=biblio href=#biblio-css21 title=biblio-css21>[CSS21]</a> that that element belongs to.</p>

<h3 class="heading settled heading" data-level=3.3 id=csscompositingrules_SVG><span class=secno>3.3 </span><span class=content>Behavior specific to SVG</span><a class=self-link href=#csscompositingrules_SVG></a></h3>

<p>By default, every element must create a <a href=#isolatedgroups>non-isolated group</a>.</p>



<p>However, certain operations in SVG will create <a href=#isolatedgroups>isolated groups</a>. If one of the following features is used, the group must become isolated:</p>

<ul>
<li>opacity</li>
<li>filters</li>
<li>3D transforms (2D transforms must NOT cause isolation)</li>
<li>blending</li>
<li>masking</li>
</ul>

<h3 class="heading settled heading" data-level=3.4 id=csskeywords><span class=secno>3.4 </span><span class=content>CSS Properties</span><a class=self-link href=#csskeywords></a></h3>


<h4 class="heading settled heading" data-level=3.4.1 id=mix-blend-mode><span class=secno>3.4.1 </span><span class=content>The <a class=property data-link-type=propdesc href=#propdef-mix-blend-mode title=mix-blend-mode>mix-blend-mode</a> property</span><a class=self-link href=#mix-blend-mode></a></h4>

<p>The blend mode defines the formula that must be used to mix the colors with the backdrop.
This behavior is described in more detail in <a href=#blending>Blending</a>.</p>

<table class="definition propdef"><tr><th>Name:<td><dfn class=css-code data-dfn-type=property data-export="" id=propdef-mix-blend-mode>mix-blend-mode<a class=self-link href=#propdef-mix-blend-mode></a></dfn><tr><th>Value:<td class=prod><a class="production css-code" data-link-type=type href=#ltblendmodegt title="<blend-mode>">&lt;blend-mode&gt;</a><tr><th>Initial:<td>normal<tr><th>Applies to:<td>All elements. In SVG, it applies to <a href=http://www.w3.org/TR/SVG/intro.html#TermContainerElement>container elements</a>, <a href=http://www.w3.org/TR/SVG/intro.html#TermGraphicsElement>graphics elements</a> and <a href=http://www.w3.org/TR/2011/REC-SVG11-20110816/intro.html#TermGraphicsReferencingElement>graphics referencing elements</a>. <a data-biblio-type=informative data-link-type=biblio href=#biblio-svg11 title=biblio-svg11>[SVG11]</a><tr><th>Inherited:<td>no<tr><th>Media:<td>visual<tr><th>Computed value:<td>as specified<tr><th>Percentages:<td>N/A<tr><th>Animatable:<td>no</table>

 

<p>The syntax of the property of <a class="production css-code" data-link-type=type href=#ltblendmodegt title="<blend-mode>">&lt;blend-mode&gt;</a> is given with:</p>

<pre class=blendmode><dfn class=css-code data-dfn-type=type data-export="" id=ltblendmodegt>&lt;blend-mode&gt;<a class=self-link href=#ltblendmodegt></a></dfn> = <a class=css-code data-link-type=value href=#valuedef-normal title=normal>normal</a> | <a class=css-code data-link-type=value href=#valuedef-multiply title=multiply>multiply</a> | <a class=css-code data-link-type=value href=#valuedef-screen title=screen>screen</a> | <a class=css-code data-link-type=value href=#valuedef-overlay title=overlay>overlay</a> | <a class=css-code data-link-type=value href=#valuedef-darken title=darken>darken</a> | <a class=css-code data-link-type=value href=#valuedef-lighten title=lighten>lighten</a> | <a class=css-code data-link-type=value href=#valuedef-color-dodge title=color-dodge>color-dodge</a> |
<a class=css-code data-link-type=value href=#valuedef-color-burn title=color-burn>color-burn</a> | <a class=css-code data-link-type=value href=#valuedef-hard-light title=hard-light>hard-light</a> | <a class=css-code data-link-type=value href=#valuedef-soft-light title=soft-light>soft-light</a> | <a class=css-code data-link-type=value href=#valuedef-difference title=difference>difference</a> | <a class=css-code data-link-type=value href=#valuedef-exclusion title=exclusion>exclusion</a> | <a class=css-code data-link-type=value href=#valuedef-hue title=hue>hue</a> | 
<a class=css-code data-link-type=value href=#valuedef-saturation title=saturation>saturation</a> | <a class=css-code data-link-type=value href=#valuedef-color title=color>color</a> | <a class=css-code data-link-type=value href=#valuedef-luminosity title=luminosity>luminosity</a></pre>

<p class=note>Note: Applying a blendmode other than <a class=css-code data-link-type=value href=#valuedef-normal title=normal>normal</a> to the element must establish a new <a data-link-spec=css21 data-link-type=dfn href=http://dev.w3.org/csswg/css2/visuren.html#x44 title="stacking context">stacking context</a> <a data-biblio-type=normative data-link-type=biblio href=#biblio-css21 title=biblio-css21>[CSS21]</a>. This group must then be blended and composited with the <a data-link-spec=css21 data-link-type=dfn href=http://dev.w3.org/csswg/css2/visuren.html#x44 title="stacking context">stacking context</a> that contains the element.</p>

<div class=example>
<p>Given the following sample markup:</p>
<pre>&lt;body&gt;
   &lt;img src="ducky.png"/&gt;
&lt;/body&gt;"
</pre>
<p>And the following style rule:</p>
<pre>body { background-color: green; }
</pre>
<p>
... will produce the following result:
</p>
<div class=figure>
<img alt="example of an image of duck with the green color of the document" src=examples/ducky_normal.png style=width:30%>
<p class=caption>
Partially transparent image on a green backdrop</p>
</div>
<p>If we change the style rule to include blending:</p>
<pre>body { background-color: green; }
img { mix-blend-mode: multiply; }
</pre>
<p>
... the output will be the image blending with the green background of the &lt;body&gt; element.
</p>
<div class=figure>
<img alt="example of an image of duck blending with the green color of the document" src=examples/ducky_multiply.png style=width:30%>
<p class=caption>
Blending of a transparent image on a green backdrop.
</p>
</div>
</div>

<div class=example>
<p>Given the following svg code:</p>
<pre>&lt;svg&gt;
  &lt;circle cx="40" cy="40" r="40" fill="red"/&gt;
  &lt;circle cx="80" cy="40" r="40" fill="green"/&gt;
  &lt;circle cx="60" cy="80" r="40" fill="blue"/&gt;
&lt;/svg&gt;
</pre>
<p>And the following style rule:</p>
<pre>circle { mix-blend-mode: screen; }
</pre>
<p>
... the output will be blending of the 3 circles. Each circle is rendered from bottom to top. Where the elements overlap, the blend mode produces a change in color.
</p>
<div class=figure>
<img alt="example of 3 circles blending with a screen blend mode" src=examples/screen_example.svg style=width:30%>
<p class=caption>
Example of 3 circles blending with a screen blend mode
</p>
</div>

</div>

<div class=example>
<p>In the following style sheet and document fragment:</p>
<pre>body { background-color: green; }
div { background-color: red; width: 200px; opacity: .95}
img { mix-blend-mode: difference; }

&lt;body&gt;
  &lt;div&gt;
     &lt;img src="ducky.png"/&gt;
  &lt;/div&gt;
&lt;/body&gt;
</pre>
<p>
... the <a class=property data-link-type=propdesc href=http://dev.w3.org/csswg/css-color-3/#opacity title=opacity>opacity</a> on the &lt;div&gt; element is causing the creation of a stacking context. This causes the creation of a new group so the image doesn’t blend with the color of the &lt;body&gt;.
</p>
<div class=figure>
<img alt="example of an image of duck blending with the green color of the document" src=examples/ducky_difference.png style=width:30%>
<p class=caption>
Example of blending within a stacking context.</p>
</div>
<p>
Note how the image is not blending with the green color.
</p>
</div>

<div class=example>
<p>Given the following sample markup:</p>
<pre><pre>&lt;body&gt;
   &lt;div&gt;
     &lt;p&gt;'overlay' blending on text&lt;/p&gt;
   &lt;/div&gt;
&lt;/body&gt;
</pre><p>And the following style rule:</p>
<pre>div { background-image: url('texture.png'); }
@font-face {
  font-family: "Mythos Std";
  src: url("http://myfontvendor.com/mythos.otf");
}
p {
  mix-blend-mode: overlay;
  font-family: "Mythos Std" 
}
</pre><div class=figure>
<img alt="example of text that has an overlay blend on top of a texture" src=examples/overlay_text.png style=width:75%>
<p class=caption>
Text with a blend overlay on top of an image.
</p>
</div>
</pre></div>

<h4 class="heading settled heading" data-level=3.4.2 id=isolation><span class=secno>3.4.2 </span><span class=content>The <a class=property data-link-type=propdesc href=#propdef-isolation title=isolation>isolation</a> property</span><a class=self-link href=#isolation></a></h4>

In SVG, this defines whether an element is isolated or not.<br>
For CSS, setting <a class=property data-link-type=propdesc href=#propdef-isolation title=isolation>isolation</a> to <span class=css data-link-type=maybe title=isolate>isolate</span> will turn the element into a stacking context.

By default, elements use the <span class=css data-link-type=maybe title=auto>auto</span> keyword which implies that they are not isolated. However operations that cause the creation of stacking context <a data-biblio-type=normative data-link-type=biblio href=#biblio-css21 title=biblio-css21>[CSS21]</a> must cause a group to be isolated. These operations are described in <a href=#csscompositingrules_CSS>'behavior specific to HTML'</a> and <a href=#csscompositingrules_SVG>'behavior specific to SVG'</a>.

<table class="definition propdef"><tr><th>Name:<td><dfn class=css-code data-dfn-type=property data-export="" id=propdef-isolation>isolation<a class=self-link href=#propdef-isolation></a></dfn><tr><th>Value:<td class=prod><a class="production css-code" data-link-type=type href=#isolated-propid title="<isolation-mode>">&lt;isolation-mode&gt;</a><tr><th>Initial:<td>auto<tr><th>Applies to:<td>All elements. In SVG, it applies to <a href=http://www.w3.org/TR/SVG/intro.html#TermContainerElement>container elements</a>, <a href=http://www.w3.org/TR/SVG/intro.html#TermGraphicsElement>graphics elements</a> and <a href=http://www.w3.org/TR/2011/REC-SVG11-20110816/intro.html#TermGraphicsReferencingElement>graphics referencing elements</a>. <a data-biblio-type=informative data-link-type=biblio href=#biblio-svg11 title=biblio-svg11>[SVG11]</a><tr><th>Inherited:<td>no<tr><th>Media:<td>visual<tr><th>Computed value:<td>as specified<tr><th>Percentages:<td>N/A<tr><th>Animatable:<td>no</table>
The syntax of the property of <a class="production css-code" data-link-type=type href=#isolated-propid title="<isolation-mode>">&lt;isolation-mode&gt;</a> is given with:

<pre class=isolated><dfn class=css-code data-dfn-type=type data-export="" id=isolated-propid>&lt;isolation-mode&gt;<a class=self-link href=#isolated-propid></a></dfn> = auto | isolate</pre>
<p id=img_isolation>
In CSS, a background image or the content of an <a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-img-element title=img>img</a> must always be rendered into an isolated group.<br>For instance, if you link to an SVG file through the <a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-img-element title=img>img</a> tag, the artwork of that SVG will not blend with the backdrop of the content.</p>

In SVG, <a class=property data-link-type=propdesc href=http://www.w3.org/TR/SVG/masking.html#MaskProperty title=mask>mask</a> always creates an isolated group.



<h4 class="heading settled heading" data-level=3.4.3 id=background-blend-mode><span class=secno>3.4.3 </span><span class=content>The <a class=property data-link-type=propdesc href=#propdef-background-blend-mode title=background-blend-mode>background-blend-mode</a> property</span><a class=self-link href=#background-blend-mode></a></h4>

Defines the blending mode of each background layer.

Each background layer must blend with the element’s background layer that is below it and the element’s background color. Background layers must not blend with the content that is behind the element, instead they must act as if they are rendered into an isolated group.

The description of the <a class=property data-link-type=propdesc href=#propdef-background-blend-mode title=background-blend-mode>background-blend-mode</a> property is as follows:

<table class="definition propdef"><tr><th>Name:<td><dfn class=css-code data-dfn-type=property data-export="" id=propdef-background-blend-mode>background-blend-mode<a class=self-link href=#propdef-background-blend-mode></a></dfn><tr><th>Value:<td class=prod><a class="production css-code" data-link-type=type href=#ltblendmodegt title="<blend-mode>">&lt;blend-mode&gt;</a><tr><th>Initial:<td>normal<tr><th>Applies to:<td>All HTML elements<tr><th>Inherited:<td>no<tr><th>Media:<td>visual<tr><th>Computed value:<td>as specified<tr><th>Percentages:<td>N/A<tr><th>Animatable:<td>no</table>
The <a class=property data-link-type=propdesc href=#propdef-background-blend-mode title=background-blend-mode>background-blend-mode</a> list must be applied in the same order as <a class=property data-link-type=propdesc href=http://dev.w3.org/csswg/css-backgrounds-3/#background-image title=background-image>background-image</a> <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3bg title=biblio-css3bg>[CSS3BG]</a>. This means that the first element in the list will apply to the layer that is on top. If a property doesn’t have enough comma-separated values to match the number of layers, the UA must calculate its used value by repeating the list of values until there are enough.<p></p>

If the <a class=property data-link-type=propdesc href=http://dev.w3.org/csswg/css-backgrounds-3/#background title=background>background</a> <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3bg title=biblio-css3bg>[CSS3BG]</a> shorthand is used, the <a class=property data-link-type=propdesc href=#propdef-background-blend-mode title=background-blend-mode>background-blend-mode</a>
property for that element must be reset to its initial value.

<div class=example>
<p>Given the following sample markup:</p>
<pre>&lt;body&gt;
   &lt;div&gt;&lt;/div&gt;
&lt;/body&gt;
</pre><p>And the following style rule:</p>
<pre>body { background-color: green; }
div { 
  width: 200px;
  height: 200px;
  background-size: 200px 200px;
  background-repeat:no-repeat;
  background-image: linear-gradient(to right, #000000 0%,#ffffff 100%), url('ducky.png');
  background-blend-mode: difference, normal;
}
</pre><div class=figure>
<img alt="example of div that has an image of a duck and a gradient that is blending" src=examples/ducky_background_blend.png style=width:30%>
<p class=caption>
Blending of 2 background images.
</p>
</div>
<p>
Note that the gradient is not blending with the color of <a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/sections.html#the-body-element title=body>body</a>. Instead it retains its original color.
</p>
</div>

<h2 class="heading settled heading" data-level=4 id=canvascompositingandblending><span class=secno>4 </span><span class=content>Specifying Compositing and Blending in Canvas 2D</span><a class=self-link href=#canvascompositingandblending></a></h2>

The <a href=http://www.w3.org/TR/2dcontext>canvas 2d</a> context defines the <a href=http://www.w3.org/TR/2dcontext/#dom-context-2d-globalcompositeoperation>‘globalCompositeOperation’</a> attribute that is used to set the current compositing and blending operator.

This property takes the following value:

<div class=propdef>
<dl>
  <dt id=propdef-mix><a class=self-link href=#propdef-mix></a><span class="propdef-title prop-name">‘globalCompositeOperation’</span></dt>
    <dd>
      <table cellpadding=0 cellspacing=0 class=propinfo summary="knock-out property">
        <tbody>
          <tr valign=baseline>
            <td><em>Value:</em>  </td>
            <td> <a class="production css-code" data-link-type=type href=#ltblendmodegt title="<blend-mode>">&lt;blend-mode&gt;</a> | <a class="production css-code" data-link-type=type href=#ltcompositegt title="<composite-mode>">&lt;composite-mode&gt;</a> </td>
          </tr>
          <tr valign=baseline>
            <td><em>Initial:</em>  </td>
            <td>source-over</td>
          </tr>
        </tbody>
      </table>
    </dd>
</dl>
</div>

The syntax of the property of <a class="production css-code" data-link-type=type href=#ltcompositegt title="<composite-mode>">&lt;composite-mode&gt;</a> is given with:

<pre class=composite><dfn class=css-code data-dfn-type=type data-export="" id=ltcompositegt>&lt;composite-mode&gt;<a class=self-link href=#ltcompositegt></a></dfn> = <a href=#porterduffcompositingoperators_clear>clear</a> | <a href=#porterduffcompositingoperators_src>copy</a> | <a href=#porterduffcompositingoperators_dst>destination</a> | <a href=#porterduffcompositingoperators_srcover>source-over</a> | <a href=#porterduffcompositingoperators_dstover>destination-over</a> | <a href=#porterduffcompositingoperators_srcin>source-in</a> | <br><a href=#porterduffcompositingoperators_dstin>destination-in</a> | <a href=#porterduffcompositingoperators_srcout>source-out</a> | <a href=#porterduffcompositingoperators_dstout>destination-out</a> | <a href=#porterduffcompositingoperators_srcatop>source-atop</a> | <a href=#porterduffcompositingoperators_dstatop>destination-atop</a> | <a href=#porterduffcompositingoperators_xor>xor</a> | <a href=#porterduffcompositingoperators_plus>lighter</a></pre>
<h2 class="heading settled heading" data-level=5 id=whatiscompositing><span class=secno>5 </span><span class=content>Introduction to compositing</span><a class=self-link href=#whatiscompositing></a></h2>

Compositing is the combining of a graphic element with its backdrop.


In the model described in this specification there are two steps to the overall compositing operation - <a href=#advancedcompositing>Porter-Duff compositing</a> and <a href=#blending>blending</a>.

The blending step determines how the colors from the graphic element and the backdrop interact.

Typically, the blending step is performed first, followed by the Porter-Duff compositing step.
In the blending step, the resultant color from the mix of the element and the the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> is calculated. The graphic element’s color is replaced with this resultant color.
The graphic element is then composited with the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> using the specified compositing operator.

Note: Shape is defined by the mathematical description of the shape. A particular point is either inside the shape or it is not. There are no gradations.

Note: Opacity is described using an alpha value, stored alongside the color value for each particular point. The alpha value is between 0 and 1, inclusive.
 A value of 0 means that the pixel has no coverage at that point, and is therefore
transparent; i.e. there is no color contribution from any geometry because the geometry does not overlap this pixel. A value of 1 means that the pixel is fully opaque; the geometry completely overlaps the pixel.

<h3 class="heading settled heading" data-level=5.1 id=simplealphacompositing><span class=secno>5.1 </span><span class=content>Simple alpha compositing</span><a class=self-link href=#simplealphacompositing></a></h3>

The formula for simple alpha compositing is

<pre>co = Cs x αs + Cb x αb x (1 - αs)
</pre>
Where 

<ul>
<li>co: the premultiplied pixel value after compositing
<li>Cs: the color value of the source graphic element being composited
<li>αs: the alpha value of the source graphic element being composited
<li>Cb: the color value of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a>
<li>αb: the alpha value of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a>
</ul>

Note: All values are between 0 and 1 inclusive.

The pixel value after compositing (co) is given by adding the contributions from the source graphic element [Cs x αs] and the backdrop [Cb x αb x (1 - αs)].
For both the graphic element and the backdrop, the color values are multiplied by the alpha to determine the amount of color that contributes.
With zero alpha meaning that the color does not contribute and partial alpha means that some percentage of the color contributes.
The contribution of the backdrop is further reduced based on the opacity of the graphic element. 
Conceptually, (1 - αs) of the backdrop shows through the graphic element, meaning that if the graphic element is fully opaque (αs=1) then no backdrop shows through.

The simple alpha compositing formula listed above gives a resultant color which is the result of the 
weighted average of the backdrop color and graphic element color, with the weighting determined by the backdrop and
graphic element alphas.
The resultant alpha value of the composite is simply the sum of the contributed alpha of the composited elements.
The formula for the resultant alpha of the composite is

<pre>αo = αs + αb x (1 - αs)
</pre>
Where 

<ul>
<li>αo: the alpha value of the composite
<li>αs: the alpha value of the graphic element being composited
<li>αb: the alpha value of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a>
</ul>
<p></p>

<div class=note>
<p>
Often, it can be more efficient to store a <code>pre-multiplied value</code> for the color and opacity.
The pre-multiplied value is given by
<pre>cs = Cs x αs
</pre>with 
<ul>
<li>cs: the pre-multiplied value
<li>Cs: the color value
<li>αs: the alpha value
</ul>
<p>
Thus the formula for simple alpha compositing using pre-multiplied values becomes
<pre>co = cs + cb x (1 - αs)
</pre><p></p>
<p></p>

<p>
To extract the color component of a pre-multiplied value, the formula is reversed:
<pre>Co = co / αo
</pre><p></p>
</div>

<h4 class="heading settled heading" data-level=5.1.1 id=simplealphacompositingexamples><span class=secno>5.1.1 </span><span class=content>Examples of simple alpha compositing</span><a class=self-link href=#simplealphacompositingexamples></a></h4>
<div class=example>
<div class=figure>
<img alt="Simple box showing alpha compositing" src=examples/simple_box.svg>
<p class=caption></p>
</div>
<p>
This describes the most basic case. It consists of 1 shape that is filled with a solid color (α = 1).
The shape is composited with an empty background. The empty background has no effect on the resultant composite.
<pre>Cs = RGB(1,0,0)
αs = 1
Cb = RGB(0,0,0)
αb = 0
co = Cs x αs + Cb x αb x (1 - αs)
co = RGB(1,0,0) x 1 + RGB(0,0,0) x 0 x (1 - 1)
co = RGB(1,0,0) x 1
co = RGB(1,0,0)
</pre><p></p>
</div>

<div class=example>
<div class=figure>
<img alt="simple shape" src=examples/two_box.svg>
<p class=caption></p>
</div>
<p>
This is a more complex example. There is no transparency, but the 2 shapes intersect.
</p>
<p>
Applying the compositing formula in the area of intersection, gives:
<pre>Cs = RGB(0,0,1)
αs = 1
Cb = RGB(1,0,0)
αb = 1

co = Cs x αs + Cb x αb x (1 - αs)
co = RGB(0,0,1) x 1 + RGB(1,0,0) x 1 x (1 - 1)
co = RGB(0,0,1) x 1 + RGB(1,0,0) x 1 x 0
co = RGB(0,0,1) x 1
co = RGB(0,0,1)
</pre>Calculating the alpha of the resultant composite
<pre>αo = αs + αb x (1 - αs)
αo = 1 + 1 x (1 - 1)
αo = 1
</pre>Calculating the color component of the resultant composite
<pre>Co = co / αo
Co = RGB(0, 0, 1) / 1
Co = RGB(0, 0, 1)
</pre><p></p>
</div>

<div class=example>
<div class=figure>
<img alt="interaction of a solid box with a transparent box on top" src=examples/two_box_transparency.svg>
<p class=caption></p>
</div>
<p>
This is an example where the shape has some transparency, but the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> is fully opaque.
</p>
<p>
Applying the compositing formula in the area of intersection, gives:
<pre>Cs = RGB(0,0,1)
αs = 0.5
Cb = RGB(1,0,0)
αb = 1

co = Cs x αs + Cb x αb x (1 - αs)
co = RGB(0,0,1) x 0.5 + RGB(1,0,0) x 1 x (1 - 0.5)
co = RGB(0,0,1) x 0.5 + RGB(1,0,0) x 0.5
co = RGB(0.5,0,0.5)
</pre>Calculating the alpha of the resultant composite
<pre>αo = αs + αb x (1 - αs)
αo = 0.5 + 1 x (1 - 0.5)
αo = 1
</pre>Calculating the color component of the resultant composite
<pre>Co = co / αo
Co = RGB(0.5, 0, 0.5) / 1
Co = RGB(0.5, 0, 0.5)
</pre><p></p>
</div>

<div class=example>
<div class=figure>
<img alt="interaction of 2 transparent boxes" src=examples/two_box_transparency_both.svg>
<p class=caption></p>
</div>
<p>
Figure 4 shows an example where both the shape and the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> are transparent.
</p>
<p>
Applying the compositing formula in the area of intersection, gives:
<pre>Cs = RGB(0,0,1)
αs = 0.5
Cb = RGB(1,0,0)
αb = 0.5

co = Cs x αs + Cb x αb x (1 - αs)
co = RGB(0,0,1) x 0.5 + RGB(1,0,0) x 0.5 x (1 - 0.5)
co = RGB(0,0,1) x 0.5 + RGB(1,0,0) x 0.25
co = RGB(0.25, 0, 0.5)
</pre>Calculating the alpha of the resultant composite
<pre>αo = αs + αb x (1 - αs)
αo = 0.5 + 0.5 x (1 - 0.5)
αo = 0.75
</pre>Calculating the color component of the resultant composite
<pre>Co = co / αo
Co = RGB(0.25, 0, 0.5) / 0.75
Co = RGB(0.33, 0, 0.66)
</pre><p></p>
</div>

<h2 class="heading settled heading" data-level=6 id=generalformula><span class=secno>6 </span><span class=content>General Formula for Compositing and Blending</span><a class=self-link href=#generalformula></a></h2>

The general formula for compositing and blending which allows for selection of the compositing operator and blending function comprises two steps.
The terms used in these functions will be described in detail in the following sections.

Apply the blend in place

<pre>Cs = (1 - αb) x Cs + αb x B(Cb, Cs)
</pre>
Composite

<pre>Co = αs x Fa x Cs + αb x Fb x Cb
</pre>
Where:

<ul>
<li><strong>Cs</strong>: is the source color
<li><strong>Cb</strong>: is the backdrop color
<li><strong>αs</strong>: is the source alpha
<li><strong>αb</strong>: is the backdrop alpha
<li><strong>B(Cb, Cs)</strong>: is the mixing function
<li><strong>Fa</strong>: is defined by the Porter Duff operator in use
<li><strong>Fb</strong>: is defined by the Porter Duff operator in use
</ul>

<h2 class="heading settled heading" data-level=7 id=backdrop><span class=secno>7 </span><span class=content>Backdrop calculation</span><a class=self-link href=#backdrop></a></h2>

The <dfn data-dfn-type=dfn data-export="" id=backdrop0>backdrop<a class=self-link href=#backdrop0></a></dfn> is the content behind the element and is what the element is composited with.
This means that the backdrop is the result of compositing all previous elements.

<h3 class="heading settled heading" data-level=7.1 id=backdropexamples><span class=secno>7.1 </span><span class=content>Examples of backdrop calculation</span><a class=self-link href=#backdropexamples></a></h3>
<div class=example>
<div class=figure>
<img alt="example of a simple backdrop calculation" src=examples/simple_backdrop.svg>
<p class=caption></p>
</div>
<p>
This example has 2 simple shapes. The backdrop for the blue shape includes the bottom right corner of the red shape .
The dotted line shows the area that is examined during compositing of the blue shape.
</p>
</div>
<div class=example>
<div class=figure>
<img alt="example of a backdrop with alpha" src=examples/simple_backdrop_alpha.svg>
<p class=caption></p>
</div>
<p>
The shape in the backdrop has an alpha value. The alpha value of the backdrop shape is preserved when the backdrop is calculated.
</p>
</div>

<h2 class="heading settled heading" data-level=8 id=groups><span class=secno>8 </span><span class=content>Compositing Groups</span><a class=self-link href=#groups></a></h2>

Compositing groups allow more control over the interaction of compositing with the backdrop. Groups can be used to specify how a compositing effect
within a group will interact with the content that is already in the scene (the backdrop).

Compositing groups may be made up of any number of elements, and may contain other compositing groups.

The default properties of a compositing group shall cause no visual difference compared to having no group. See <a href=#groupinvariance>Group Invariance</a>.

A compositing group is rendered by first compositing the elements of the group onto the initial backdrop. The result of this is a single element containing
color and alpha information. This element is then composited onto the group backdrop.
Steps shall be taken to ensure the group backdrop makes only a single contribution to the final composite.

<dl>
<dt id=initialbackdrop><a class=self-link href=#initialbackdrop></a>initial backdrop</dt>
<dd>
The initial backdrop is the backdrop used for compositing the group’s first element. This will be the same as the group backdrop in a non-isolated
group, or a fully transparent backdrop for an isolated group.
</dd>
<dt id=groupbackdrop><a class=self-link href=#groupbackdrop></a>group backdrop</dt>
<dd>
The group backdrop is the result of compositing all elements up to but not including the first element in the group.

</dd>


<h3 class="heading settled heading" data-level=8.1 id=groupinvariance><span class=secno>8.1 </span><span class=content>Group invariance</span><a class=self-link href=#groupinvariance></a></h3>

An important property of simple alpha compositing is its group invariance. This behavior is preserved in the more complex model described in this specification.
Adding or removing grouping with default attributes shall not show visual differences.

<pre>so: A + B + C = A + (B + C) = (A + B) + C</pre>
When adding attributes to the group such as  <span class=css data-link-type=maybe title=isolate>isolate</span>, blending modes other than <a class=css data-link-type=maybe href=#valuedef-normal title=normal>normal</a> or Porter Duff compositing operators other than <span class=css data-link-type=maybe title=source-over>source-over</span>, groups may no longer be invariant.

<h3 class="heading settled heading" data-level=8.2 id=isolatedgroups><span class=secno>8.2 </span><span class=content>Isolated Groups</span><a class=self-link href=#isolatedgroups></a></h3>

In an isolated group, the initial backdrop shall be black and fully transparent.

In this instance, the initial backdrop is different than the group backdrop. The only interaction with the group backdrop shall occur when the group’s
computed color, shape and alpha are composited with it.

See '<a href=#groupcompositing>Isolated groups and Porter Duff modes</a>' for a description of the effect of isolated groups on compositing.
See '<a href=#isolationblending>Effect of group isolation on blending</a>' for a description of the effect of isolated groups on blending.

<h3 class="heading settled heading" data-level=8.3 id=pagebackdrop><span class=secno>8.3 </span><span class=content>The Page Group</span><a class=self-link href=#pagebackdrop></a></h3>

The top level group is the page group. All other elements and groups are composited into this group.
The page group is an <a href=#isolatedgroups>isolated group</a>.

The page group is composited with a backdrop color of white with 100% opacity.

<h2 class="heading settled heading" data-level=9 id=advancedcompositing><span class=secno>9 </span><span class=content>Advanced compositing features</span><a class=self-link href=#advancedcompositing></a></h2>

<a href=#simplealphacompositing>Simple alpha compositing</a> uses the <a href=#porterduffcompositingoperators_srcover>source-over</a> Porter Duff compositing operator. 

Porter Duff compositing is based on a model of a pixel in which two shapes (source and destination) may contribute to the final color of the pixel. The pixel is divided into 4 sub-pixel regions and each region represents a possible combination of source and destination. [[PORTERDUFF]]<p></p>

The four regions are:

<dl>
<dt>Source Only<dd>Where only the source contributes to the pixel color</dd>
<dt>Destination only<dd>where only the destination contributes to the pixel color</dd>
<dt>Both<dd>Source and Destination – where both the source and destination may combine to define the pixel color</dd>
<dt>None<dd>No source or Destination – where neither make a contribution to the final pixel color</dd>
</dl>

Note: Destination is synonymous with backdrop. The term destination is used in this section as this is considered the standard when working with Porter Duff compositing. Additionally, the compositing operators use <span class=css data-link-type=maybe title=destination>destination</span> in their names.

<div class=figure>
<p style=text-align:center><img alt="overview of the regions affected by porter duff" src=examples/PD_regions.svg></p>
<p class=caption></p>
</div>
The contribution from each region to the final pixel color is defined by the coverage of the shape at that pixel, and the operator in use.
Coverage is specified in terms of alpha. Full alpha (1) implies full coverage, while zero alpha (0) implies no coverage.
This means that the area of each region within the sub-pixel is dependent on the coverage of each shape contributing to the pixel.
The area of each region can be calculated with the following equations:
<div class=data>
<table>
<tr>
<th>Both</th>
<th>αs x αb</th>
</tr>
<tr>
<th>Source only</th>
<th>αs x (1 – αb)</th>
</tr>
<tr>
<th>Destination only</th>
<th>αb x (1 – αs)</th>
</tr>
<tr>
<th>None</th>
<th>(1 – αs) x (1 – αb)</th>
</tr>
</table>
</div>

The figure above represents coverage of 0.5 for both source and destination.

<pre>Both = 0.5 x 0.5 = 0.25 
Source Only = 0.5 (1 – 0.5) = 0.25
Destination Only = 0.5(1 – 0.5) = 0.25
None = (1 – 0.5)(1 – 0.5) = 0.25
</pre>
Therefore, the coverage of each region is 0.25 in this example.

<h3 class="heading settled heading" data-level=9.1 id=porterduffcompositingoperators><span class=secno>9.1 </span><span class=content>The Porter Duff Compositing Operators</span><a class=self-link href=#porterduffcompositingoperators></a></h3>

The landmark paper by Thomas Porter and Tom Duff, who worked for Lucasfilm, defined the algebra of compositing and developed the twelve "Porter Duff" operators. These operators control the results of mixing the four sub-pixel regions formed by the overlapping of graphical objects that have an alpha or pixel coverage channel/value. The operators use all practical combinations of the four regions.

There are 12 basic Porter Duff operators, satisfying all possible combinations of source and destination.

From the geometric representation of each operator, the contribution of each shape can be seen to be expressed as a fraction of the total coverage of the output.
For example, in source over, the possible contribution of source is full (1) and the possible contribution of destination is whatever is remaining (1 – αs). This is modified by the coverage of source and destination to give the equation for the final coverage of the pixel:

<pre>αo = αs x 1 + αb x (1 – αs)
</pre>
The fractional terms Fa (1 in this example) and Fb (1 – αs in this example) are defined for each operator and specify the fraction of the shapes that may contribute to the final pixel value.
The general form of the equation for coverage is:

<pre>αs x Fa + αb x Fb
</pre>
and incorporating color gives the general Porter Duff equation

<pre>co = αs x Fa x Cs + αb x Fb x Cb
</pre>
Where:

<ul>
<li>co is the output color pre-multiplied with the output alpha [0 &lt;= co &lt;= 1]
<li>αs is the coverage of the source Fa is defined by the operator and controls inclusion of the source Cs is the color of the source (not multiplied by alpha)
<li>αb is the coverage of the destination Fb is defined by the operator and controls inclusion of the destination Cb is the color of the destination (not multiplied by alpha)
</ul>

<h4 class="heading settled heading" data-level=9.1.1 id=porterduffcompositingoperators_clear><span class=secno>9.1.1 </span><span class=content>Clear</span><a class=self-link href=#porterduffcompositingoperators_clear></a></h4>

No regions are enabled.

<div class=figure>
<img alt="example of porter duff clear" src=examples/PD_clr.svg>
<p class=caption></p>
</div>
<pre>Fa = 0; Fb = 0
co = 0
αo = 0
</pre><h4 class="heading settled heading" data-level=9.1.2 id=porterduffcompositingoperators_src><span class=secno>9.1.2 </span><span class=content>Copy</span><a class=self-link href=#porterduffcompositingoperators_src></a></h4>
<p>Only the source will be present.</p>
<div class=figure>
<img alt="example of porter duff copy" src=examples/PD_src.svg>
<p class=caption></p>
</div>
<pre>Fa = 1; Fb = 0
co = αs x Cs
αo = αs
</pre>
<h4 class="heading settled heading" data-level=9.1.3 id=porterduffcompositingoperators_dst><span class=secno>9.1.3 </span><span class=content>Destination</span><a class=self-link href=#porterduffcompositingoperators_dst></a></h4>

Only the destination will be present.

<div class=figure>
<img alt="example of porter duff destination" src=examples/PD_dst.svg>
<p class=caption></p>
</div>
<pre>Fa = 0; Fb = 1
co = αb x Cb
αo = αb
</pre>
<h4 class="heading settled heading" data-level=9.1.4 id=porterduffcompositingoperators_srcover><span class=secno>9.1.4 </span><span class=content>Source Over</span><a class=self-link href=#porterduffcompositingoperators_srcover></a></h4>

Source is placed over the destination.

<div class=figure>
<img alt="example of porter duff source over" src=examples/PD_src-over.svg>
<p class=caption></p>
</div>
<pre>Fa = 1; Fb = 1 – αs
co = αs x Cs + αb x Cb x (1 – αs)
αo = αs + αb x (1 – αs)
</pre><h4 class="heading settled heading" data-level=9.1.5 id=porterduffcompositingoperators_dstover><span class=secno>9.1.5 </span><span class=content>Destination Over</span><a class=self-link href=#porterduffcompositingoperators_dstover></a></h4>

Destination is placed over the source.

<div class=figure>
<img alt="example of porter duff destination over" src=examples/PD_dst-over.svg>
<p class=caption></p>
</div>
<pre>Fa = 1 – αb; Fb = 1
co = αs x Cs x (1 – αb) + αb x Cb
αo = αs x (1 – αb) + αb
</pre>
<h4 class="heading settled heading" data-level=9.1.6 id=porterduffcompositingoperators_srcin><span class=secno>9.1.6 </span><span class=content>Source In</span><a class=self-link href=#porterduffcompositingoperators_srcin></a></h4>

The source that overlaps the destination, replaces the destination.

<div class=figure>
<img alt="example of porter duff source in" src=examples/PD_src-in.svg>
<p class=caption></p>
</div>
<pre>Fa = αb; Fb = 0
co = αs x Cs x αb
αo = αs x αb
</pre>
<h4 class="heading settled heading" data-level=9.1.7 id=porterduffcompositingoperators_dstin><span class=secno>9.1.7 </span><span class=content>Destination In</span><a class=self-link href=#porterduffcompositingoperators_dstin></a></h4>
Destination which overlaps the source, replaces the source.

<div class=figure>
<img alt="example of porter duff destination in " src=examples/PD_dst-in.svg>
<p class=caption></p>
</div>
<pre>Fa = 0; Fb = αs
co = αb x Cb x αs 
αo = αb x αs
</pre>
<h4 class="heading settled heading" data-level=9.1.8 id=porterduffcompositingoperators_srcout><span class=secno>9.1.8 </span><span class=content>Source Out</span><a class=self-link href=#porterduffcompositingoperators_srcout></a></h4>

Source is placed, where it falls outside of the destination.

<div class=figure>
<img alt="example of porter duff source out" src=examples/PD_src-out.svg>
<p class=caption></p>
</div>
<pre>Fa = 1 – αb; Fb = 0
co = αs x Cs x (1 – αb)
αo = αs x (1 – αb)
</pre>
<h4 class="heading settled heading" data-level=9.1.9 id=porterduffcompositingoperators_dstout><span class=secno>9.1.9 </span><span class=content>Destination Out</span><a class=self-link href=#porterduffcompositingoperators_dstout></a></h4>

Destination is placed, where it falls outside of the source.

<div class=figure>
<img alt="example of porter duff destination out" src=examples/PD_dst-out.svg>
<p class=caption></p>
</div>
<pre>Fa = 0; Fb = 1 – αs
co = αb x Cb x (1 – αs)
αo = αb x (1 – αs)
</pre>
<h4 class="heading settled heading" data-level=9.1.10 id=porterduffcompositingoperators_srcatop><span class=secno>9.1.10 </span><span class=content>Source Atop</span><a class=self-link href=#porterduffcompositingoperators_srcatop></a></h4>

Source which overlaps the destination, replaces the destination. Destination is placed elsewhere.

<div class=figure>
<img alt="example of porter duff source atop" src=examples/PD_src-atop.svg>
<p class=caption></p>
</div>
<pre>Fa = αb; Fb = 1 – αs
co = αs x Cs x αb + αb x Cb x (1 – αs)
αo = αs x αb + αb x (1 – αs)
</pre>
<h4 class="heading settled heading" data-level=9.1.11 id=porterduffcompositingoperators_dstatop><span class=secno>9.1.11 </span><span class=content>Destination Atop</span><a class=self-link href=#porterduffcompositingoperators_dstatop></a></h4>

Destination which overlaps the source replaces the source. Source is placed elsewhere.

<div class=figure>
<img alt="example of porter duff destination atop" src=examples/PD_dst-atop.svg>
<p class=caption></p>
</div>
<pre>Fa = 1 - αb; Fb = αs
co = αs x Cs x (1 - αb) + αb x Cb x αs
αo = αs x (1 - αb) + αb x αs
</pre>
<h4 class="heading settled heading" data-level=9.1.12 id=porterduffcompositingoperators_xor><span class=secno>9.1.12 </span><span class=content>XOR</span><a class=self-link href=#porterduffcompositingoperators_xor></a></h4>

The non-overlapping regions of source and destination are combined.

<div class=figure>
<img alt="example of porter duff xor" src=examples/PD_xor.svg>
<p class=caption></p>
</div>
<pre>Fa = 1 - αb; Fb = 1 – αs
co = αs x Cs x (1 - αb) + αb x Cb x (1 – αs)
αo = αs x (1 - αb) + αb x (1 – αs)
</pre>
<h4 class="heading settled heading" data-level=9.1.13 id=porterduffcompositingoperators_plus><span class=secno>9.1.13 </span><span class=content>Lighter</span><a class=self-link href=#porterduffcompositingoperators_plus></a></h4>
Display the sum of the source image and destination image. It is defined in the Porter Duff paper as the <span class=css data-link-type=maybe title=plus>plus</span> operator <a data-biblio-type=informative data-link-type=biblio href=#biblio-porterduff title=biblio-porterduff>[PORTERDUFF]</a>.

<pre>Fa = 1; Fb = 1
co = αs x Cs + αb x Cb;
αo = αs + αb
</pre>
<h3 class="heading settled heading" data-level=9.2 id=groupcompositing><span class=secno>9.2 </span><span class=content>Group compositing behavior with Porter Duff modes</span><a class=self-link href=#groupcompositing></a></h3>


When compositing the elements within an isolated group, the elements are composited over a transparent black initial backdrop. If the bottom element in the group uses a Porter Duff compositing operator
which is dependent on the backdrop, such as <a href=#porterduffcompositingoperators_dst>destination</a>, <a href=#porterduffcompositingoperators_srcin>source-in</a>, 
<a href=#porterduffcompositingoperators_dstin>destination-in</a>, <a href=#porterduffcompositingoperators_dstout>destination-out</a> or <a href=#porterduffcompositingoperators_srcatop>source-atop</a>, 
then the result of the composite will be empty. Subsequent elements within the group are composited with the result of the first composite.



<h2 class="heading settled heading" data-level=10 id=blending><span class=secno>10 </span><span class=content>Blending</span><a class=self-link href=#blending></a></h2>

Blending is the aspect of compositing that calculates the mixing of colors where the source element and <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> overlap.<br>
Conceptually, the colors in the source element are blended in place with the backdrop.
After blending, the modified source element is composited with the backdrop.
In practice, this is usually all performed in one step.
<br>The blending calculations must not use pre-multiplied color values.

The "mixing" formula is defined as:

<pre>Cm = B(Cb, Cs)
</pre>
with:

<ul>
<li>Cm: the result color after blending
<li>B: the formula that does the blending
<li>Cb: the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color
<li>Cs: the source color
</ul>

The result of the mixing formula must be clamped to the minimum and maximum values of the color range.

The result of the mixing function is modulated by the backdrop alpha. A fully opaque backdrop allows the mixing function to be fully realized.
A transparent backdrop will cause the final result to be a weighted average between the source color and mixed color with the weight controlled by the backdrop alpha.
The value of the new color  becomes:

<pre>Cr = (1 - αb) x Cs + αb x B(Cb, Cs)
</pre>
with:

<ul>
<li>Cr: the result color
<li>B: the formula that does the blending
<li>Cs: the source color
<li>Cb: the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color
<li>αb: the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> alpha
</ul>

<div class=example>
<div class=figure>
 <img alt="example of blending with opacity" src=examples/blend_background_opacity.svg>
 <p class=caption></p>
</div>
<p>
This example has a red rectangle with a blending mode that is placed on top of a set of green rectangles that have different levels of opacity.</p>
<p>
Note how the top rectangle shifts more toward red as the opacity of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> gets smaller.
</p>
</div>

<p class=note>
Note: The following formula gives the color value in the area where the source and backdrop intersects and then composites with the specified Porter Duff compositing formula. For simple alpha blending, the formula thus becomes:
<pre>simple alpha compositing:
  co = cs + cb x (1 - αs)
written as non-premultiplied:
  αo x Co = αs x Cs + (1 - αs) x αb x Cb
now substitute the result of blending for Cs:
    αo x Co = αs x ((1 - αb) x Cs + αb x B(Cb, Cs)) + (1 - αs) x αb x Cb
            = αs x (1 - αb) x Cs + αs x αb x B(Cb, Cs) + (1 - αs) x αb x Cb
</pre><p></p>

<h3 class="heading settled heading" data-level=10.1 id=blendingseparable><span class=secno>10.1 </span><span class=content>Separable blend modes</span><a class=self-link href=#blendingseparable></a></h3>

A blend mode is termed separable if each component of the result color is completely determined by the corresponding components of the constituent <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> and source colors — that is, if the mixing formula is applied <strong>separately</strong> to each set of corresponding components.

Each of the following blend modes will apply the blending function B(Cb, Cs) on each of the color components.
For simplicity, all the examples in this chapter use <a href=#porterduffcompositingoperators_srcover>source-over</a> compositing.

<h4 class="heading settled heading" data-level=10.1.1 id=blendingnormal><span class=secno>10.1.1 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-normal>normal<a class=self-link href=#valuedef-normal></a></dfn> blend mode</span><a class=self-link href=#blendingnormal></a></h4>

This is the default attribute which specifies no blending. The blending formula simply selects the source color.

<pre>B(Cb, Cs) = Cs
</pre><div class=figure>
<img alt="example of normal blending" src=examples/normal.png>
 <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.1.2 id=blendingmultiply><span class=secno>10.1.2 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-multiply>multiply<a class=self-link href=#valuedef-multiply></a></dfn> blend mode</span><a class=self-link href=#blendingmultiply></a></h4>

The source color is multiplied by the destination color and replaces the destination. 

The resultant color is always at least as dark as either the source or destination color. Multiplying any color with black results in black. Multiplying any color with white preserves the original color.

<pre>B(Cb, Cs) = Cb x Cs
</pre><p></p>
<div class=figure>
<img alt="example of multiply blending" src=examples/multiply.png>
 <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.1.3 id=blendingscreen><span class=secno>10.1.3 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-screen>screen<a class=self-link href=#valuedef-screen></a></dfn> blend mode</span><a class=self-link href=#blendingscreen></a></h4>

Multiplies the complements of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> and source color values, then complements the result.

The result color is always at least as light as either of the two constituent colors. Screening any color with white produces white; screening with black leaves the original color unchanged. The effect is similar to projecting multiple photographic slides simultaneously onto a single screen.

<pre>B(Cb, Cs) = 1 - [(1 - Cb) x (1 - Cs)]
          = Cb + Cs -(Cb x Cs)
</pre><p></p>
<div class=figure>
<img alt="example of screen blending" src=examples/screen.png>
 <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.1.4 id=blendingoverlay><span class=secno>10.1.4 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-overlay>overlay<a class=self-link href=#valuedef-overlay></a></dfn> blend mode</span><a class=self-link href=#blendingoverlay></a></h4>

Multiplies or screens the colors, depending on the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color value.

Source colors overlay the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> while preserving its highlights and shadows. The <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color is not replaced but is mixed with the source color to reflect the lightness or darkness of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a>.

<pre>B(Cb, Cs) = HardLight(Cs, Cb)
</pre>
Overlay is the inverse of the <a class=css-code data-link-type=value href=#valuedef-hard-light title=hard-light>hard-light</a> blend mode. See the definition of <a class=css-code data-link-type=value href=#valuedef-hard-light title=hard-light>hard-light</a> for the formula.

<div class=figure>
<img alt="example of overlay blending" src=examples/overlay.png>
 <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.1.5 id=blendingdarken><span class=secno>10.1.5 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-darken>darken<a class=self-link href=#valuedef-darken></a></dfn> blend mode</span><a class=self-link href=#blendingdarken></a></h4>

Selects the darker of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> and source colors.

The <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> is replaced with the source where the source is darker; otherwise, it is left unchanged.

<pre>B(Cb, Cs) = min(Cb, Cs)
</pre><div class=figure>
<img alt="example of darken blending" src=examples/darken.png>
 <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.1.6 id=blendinglighten><span class=secno>10.1.6 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-lighten>lighten<a class=self-link href=#valuedef-lighten></a></dfn> blend mode</span><a class=self-link href=#blendinglighten></a></h4>

Selects the lighter of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> and source colors.

The <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> is replaced with the source where the source is lighter; otherwise, it is left unchanged.

<pre>B(Cb, Cs) = max(Cb, Cs)
</pre>
Note: The result must be rounded down if it exceeds the range.

<div class=figure>
<img alt="example of lighten blending" src=examples/lighten.png>
 <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.1.7 id=blendingcolordodge><span class=secno>10.1.7 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-color-dodge>color-dodge<a class=self-link href=#valuedef-color-dodge></a></dfn> blend mode</span><a class=self-link href=#blendingcolordodge></a></h4>

Brightens the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color to reflect the source color. Painting with black produces no changes.

<pre>if(Cb == 0)
    B(Cb, Cs) = 0
else if(Cs == 1)
    B(Cb, Cs) = 1
else
    B(Cb, Cs) = min(1, Cb / (1 - Cs))
</pre>
<div class=figure>
  <img alt="example of color dodge blending" src=examples/colordodge.png>
  <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.1.8 id=blendingcolorburn><span class=secno>10.1.8 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-color-burn>color-burn<a class=self-link href=#valuedef-color-burn></a></dfn> blend mode</span><a class=self-link href=#blendingcolorburn></a></h4>

Darkens the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color to reflect the source color. Painting with white produces no change.

<pre>if(Cb == 1)
    B(Cb, Cs) = 1
else if(Cs == 0)
    B(Cb, Cs) = 0
else
    B(Cb, Cs) = 1 - min(1, (1 - Cb) / Cs)
</pre>
<div class=figure>
  <img alt="example of color burn blending" src=examples/colorburn.png>
  <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.1.9 id=blendinghardlight><span class=secno>10.1.9 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-hard-light>hard-light<a class=self-link href=#valuedef-hard-light></a></dfn> blend mode</span><a class=self-link href=#blendinghardlight></a></h4>

Multiplies or screens the colors, depending on the source color value. The effect is similar to shining a harsh spotlight on the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a>.

<pre>if(Cs &lt;= 0.5)
    B(Cb, Cs) = Multiply(Cb, 2 x Cs)
else
    B(Cb, Cs) = Screen(Cb, 2 x Cs -1)  
</pre>
See the definition of <a class=css-code data-link-type=value href=#valuedef-multiply title=multiply>multiply</a> and <a class=css-code data-link-type=value href=#valuedef-screen title=screen>screen</a> for their formulas.

<div class=figure>
  <img alt="example of hard light blending" src=examples/hardlight.png>
  <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.1.10 id=blendingsoftlight><span class=secno>10.1.10 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-soft-light>soft-light<a class=self-link href=#valuedef-soft-light></a></dfn> blend mode</span><a class=self-link href=#blendingsoftlight></a></h4>

Darkens or lightens the colors, depending on the source color value. The effect is similar to shining a diffused spotlight on the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a>.

<pre>if(Cs &lt;= 0.5)
    B(Cb, Cs) = Cb - (1 - 2 x Cs) x Cb x (1 - Cb)
else
    B(Cb, Cs) = Cb + (2 x Cs - 1) x (D(Cb) - Cb)
with
if(Cb &lt;= 0.25)
    D(Cb) = ((16 * Cb - 12) x Cb + 4) x Cb
else
    D(Cb) = sqrt(Cb)
</pre>
<div class=figure>
  <img alt="example of soft light blending" src=examples/softlight.png>
  <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.1.11 id=blendingdifference><span class=secno>10.1.11 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-difference>difference<a class=self-link href=#valuedef-difference></a></dfn> blend mode</span><a class=self-link href=#blendingdifference></a></h4>

Subtracts the darker of the two constituent colors from the lighter color.

Painting with white inverts the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color; painting with black produces no change.

<pre>B(Cb, Cs) = | Cb - Cs |
</pre><p></p>
<div class=figure>
  <img alt="example of difference blending" src=examples/difference.png>
  <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.1.12 id=blendingexclusion><span class=secno>10.1.12 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-exclusion>exclusion<a class=self-link href=#valuedef-exclusion></a></dfn> blend mode</span><a class=self-link href=#blendingexclusion></a></h4>

Produces an effect similar to that of the Difference mode but lower in contrast. Painting with white inverts the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color; painting with black produces no change

<pre>B(Cb, Cs) = Cb + Cs - 2 x Cb x Cs
</pre><p></p>
<div class=figure>
  <img alt="example of exclusion blending" src=examples/exclusion.png>
  <p class=caption></p>
</div>

<h3 class="heading settled heading" data-level=10.2 id=blendingnonseparable><span class=secno>10.2 </span><span class=content>Non-separable blend modes</span><a class=self-link href=#blendingnonseparable></a></h3>

Nonseparable blend modes consider all color components in combination as opposed to the separable ones that look at each component individually.
All of these blend modes conceptually entail the following steps:

<ol>
 <li>Convert the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> and source colors from the blending color space to an intermediate hue-saturation-luminosity representation.</li>
 <li>Create a new color from some combination of hue, saturation, and luminosity components selected from the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> and source colors.</li>
 <li>Convert the result back to the original color space.</li>
</ol>

The nonseparable blend mode formulas make use of several auxiliary functions:

<pre>Lum(C) = 0.3 x Cred + 0.59 x Cgreen + 0.11 x Cblue

ClipColor(C)
    L = Lum(C)
    n = min(Cred, Cgreen, Cblue)
    x = max(Cred, Cgreen, Cblue)
    if(n &lt; 0)
        C = L + (((C - L) * L) / (L - n))
                  
    if(x &gt; 1)
        C = L + (((C - L) * (1 - L)) / (x - L))
    
    return C

SetLum(C, l)
    d = l - Lum(C)
    Cred = Cred + d
    Cgreen = Cgreen + d
    Cblue = Cblue + d
    return ClipColor(C)
    
Sat(C) = max(Cred, Cgreen, Cblue) - min(Cred, Cgreen, Cblue)
    
The subscripts min, mid, and max in the next function refer to the color
components having the minimum, middle, and maximum values upon entry to the function.

SetSat(C, s)
    if(Cmax &gt; Cmin)
        Cmid = (((Cmid - Cmin) x s) / (Cmax - Cmin))
        Cmax = s
    else
        Cmid = Cmax = 0
    Cmin = 0
    return C;
</pre>
<h4 class="heading settled heading" data-level=10.2.1 id=blendinghue><span class=secno>10.2.1 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-hue>hue<a class=self-link href=#valuedef-hue></a></dfn> blend mode</span><a class=self-link href=#blendinghue></a></h4>

Creates a color with the hue of the source color and the saturation and luminosity of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color.

<pre>B(Cb, Cs) = SetLum(SetSat(Cs, Sat(Cb)), Lum(Cb))
</pre><div class=figure>
  <img alt="example of hue blending" src=examples/hue.png>
  <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.2.2 id=blendingsaturation><span class=secno>10.2.2 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-saturation>saturation<a class=self-link href=#valuedef-saturation></a></dfn> blend mode</span><a class=self-link href=#blendingsaturation></a></h4>

Creates a color with the saturation of the source color and the hue and luminosity of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color. Painting with this mode in an area of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> that is a pure gray (no saturation) produces no change.

<pre>B(Cb, Cs) = SetLum(SetSat(Cb, Sat(Cs)), Lum(Cb))
</pre><div class=figure>
  <img alt="example of saturation blending" src=examples/saturation.png>
  <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.2.3 id=blendingcolor><span class=secno>10.2.3 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-color>color<a class=self-link href=#valuedef-color></a></dfn> blend mode</span><a class=self-link href=#blendingcolor></a></h4>

Creates a color with the hue and saturation of the source color and the luminosity of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color. This preserves the gray levels of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> and is useful for coloring monochrome images or tinting color images.

<pre>B(Cb, Cs) = SetLum(Cs, Lum(Cb))
</pre><div class=figure>
  <img alt="example of color blending" src=examples/color.png>
  <p class=caption></p>
</div>

<h4 class="heading settled heading" data-level=10.2.4 id=blendingluminosity><span class=secno>10.2.4 </span><span class=content><dfn class=css-code data-dfn-for="<blend-mode>" data-dfn-type=value data-export="" id=valuedef-luminosity>luminosity<a class=self-link href=#valuedef-luminosity></a></dfn> blend mode</span><a class=self-link href=#blendingluminosity></a></h4>

Creates a color with the luminosity of the source color and the hue and saturation of the <a data-link-type=dfn href=#backdrop0 title=backdrop>backdrop</a> color. This produces an inverse effect to that of the Color mode.
<pre>B(Cb, Cs) = SetLum(Cb, Lum(Cs))
</pre><div class=figure>
  <img alt="example of luminosity blending" src=examples/luminosity.png>
  <p class=caption></p>
</div>

<h3 class="heading settled heading" data-level=10.3 id=isolationblending><span class=secno>10.3 </span><span class=content>Effect of group isolation on blending</span><a class=self-link href=#isolationblending></a></h3>

Note: In the following example, the elements used to construct the paper airplane are within a group. Each of these elements has their blend mode set to multiply.

<div class=example>
The airplane on the left is a normal group, the airplane on the right is an <a href=#isolatedgroups>isolated group</a>.<p></p>
<p>
In the isolated group, the elements within the group are composited onto an empty initial backdrop, this stops the elements within the group multiplying with the backdrop.
In the normal group, the elements within the group are composited onto the initial backdrop containing the land and sky. Therefore the elements of the airplane multiply with the land and sky.
In both instances, the result of the group composite is composited onto the land and sky using the normal mix-blend-mode (the default mix-blend-mode applied to the group).

  <div class=figure>
  <img alt="example of isolated group blending" src=examples/isolate_blend_example.png>
  <p class=caption></p>
</div>

</div>

<h2 class="heading settled heading" data-level=11 id=security><span class=secno>11 </span><span class=content>Security issues with compositing and blending</span><a class=self-link href=#security></a></h2>

It is important that the timing to the blending and compositing operations is independent of the source and destination pixel. Operations must be implemented in such a way that they always take the same amount of time regardless of the pixel values.<p></p>

<div class=note>
<p>
If this rule is not followed, an attacker could infer information and mount a timing attack.
</p>
<p>A timing attack is a method of obtaining information about content that
   is otherwise protected, based on studying the amount of time it takes for
   an operation to occur. If, for example, red pixels took longer to
   draw than green pixels, one might be able to reconstruct a rough image of 
   the element being rendered, without ever having access to the content 
   of the element.</p>
</div>

<h2 class="heading settled heading" data-level=12 id=changes><span class=secno>12 </span><span class=content>Changes</span><a class=self-link href=#changes></a></h2>

The following changes were made relative to the <a href=http://www.w3.org/TR/2013/WD-compositing-1-20131010/> Last Call
Working draft of 7 January 2014</a>:

<ul>
  <li>unneeded normative and informative references were removed</li>
</ul>

The following changes were made relative to the <a href=http://www.w3.org/TR/2013/WD-compositing-1-20131010/> Last Call
Working draft of 10 October 2013</a>:

 <ul>
 <li>knockout was removed from the non-normative section</li>
 <li>removed paragraph on SVG from simple alpha compositing</li>
 <li>updated abstract to include CSS and clarify intent</li>
 <li>removed clip-to-self and its references</li>
 <li>Changed section 5-10 to be normative + clarified notes/examples in those sections</li>
 </ul>

The following changes were made relative to the <a href=http://www.w3.org/TR/2013/WD-compositing-1-20130625/>Working
Draft of 2013-06-25</a>:
 
 <ul>
 <li>clipping was removed as one of the operators that 
 creates an isolated group in SVG
 <li>background-blend-mode was changed so it matches 
 repeating behavior of other background syntaxes.
 <li>The mix-composite property was removed
 <li>all open issues were resolved
 </ul>




<h2 class="no-ref no-num heading settled heading" id=conformance><span class=content>
Conformance</span><a class=self-link href=#conformance></a></h2>

<h3 class="no-ref heading settled heading" id=conventions><span class=content>
Document conventions</span><a class=self-link href=#conventions></a></h3>

    <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc2119 title=biblio-rfc2119>[RFC2119]</a></p>

    <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    <div class=example>
        <p>This is an example of an informative example.</p>
    </div>

    <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this:

    <p class=note>Note, this is an informative note.</p>

<h3 class="no-ref heading settled heading" id=conformance-classes><span class=content>
Conformance classes</span><a class=self-link href=#conformance-classes></a></h3>

    <p>Conformance to this specification
    is defined for three conformance classes:
    <dl>
        <dt>style sheet
            <dd>A <a href=http://www.w3.org/TR/CSS21/conform.html#style-sheet>CSS
            style sheet</a>.
        <dt>renderer
            <dd>A <a href=http://www.w3.org/TR/CSS21/conform.html#user-agent>UA</a>
            that interprets the semantics of a style sheet and renders
            documents that use them.
        <dt>authoring tool
            <dd>A <a href=http://www.w3.org/TR/CSS21/conform.html#user-agent>UA</a>
            that writes a style sheet.
    </dl>

    <p>A style sheet is conformant to this specification
    if all of its statements that use syntax defined in this module are valid
    according to the generic CSS grammar and the individual grammars of each
    feature defined in this module.

    <p>A renderer is conformant to this specification
    if, in addition to interpreting the style sheet as defined by the
    appropriate specifications, it supports all the features defined
    by this specification by parsing them correctly
    and rendering the document accordingly. However, the inability of a
    UA to correctly render a document due to limitations of the device
    does not make the UA non-conformant. (For example, a UA is not
    required to render color on a monochrome monitor.)

    <p>An authoring tool is conformant to this specification
    if it writes style sheets that are syntactically correct according to the
    generic CSS grammar and the individual grammars of each feature in
    this module, and meet all other conformance requirements of style sheets
    as described in this module.

<h3 class="no-ref heading settled heading" id=partial><span class=content>
Partial implementations</span><a class=self-link href=#partial></a></h3>

    <p>So that authors can exploit the forward-compatible parsing rules to
    assign fallback values, CSS renderers <strong>must</strong>
    treat as invalid (and <a href=http://www.w3.org/TR/CSS21/conform.html#ignore>ignore
    as appropriate</a>) any at-rules, properties, property values, keywords,
    and other syntactic constructs for which they have no usable level of
    support. In particular, user agents <strong>must not</strong> selectively
    ignore unsupported component values and honor supported values in a single
    multi-value property declaration: if any value is considered invalid
    (as unsupported values must be), CSS requires that the entire declaration
    be ignored.</p>

<h3 class="no-ref heading settled heading" id=experimental><span class=content>
Experimental implementations</span><a class=self-link href=#experimental></a></h3>

    <p>To avoid clashes with future CSS features, the CSS2.1 specification
    reserves a <a href=http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords>prefixed
    syntax</a> for proprietary and experimental extensions to CSS.

    <p>Prior to a specification reaching the Candidate Recommendation stage
    in the W3C process, all implementations of a CSS feature are considered
    experimental. The CSS Working Group recommends that implementations
    use a vendor-prefixed syntax for such features, including those in
    W3C Working Drafts. This avoids incompatibilities with future changes
    in the draft.
    </p>

<h3 class="no-ref heading settled heading" id=testing><span class=content>
Non-experimental implementations</span><a class=self-link href=#testing></a></h3>

    <p>Once a specification reaches the Candidate Recommendation stage,
    non-experimental implementations are possible, and implementors should
    release an unprefixed implementation of any CR-level feature they
    can demonstrate to be correctly implemented according to spec.

    <p>To establish and maintain the interoperability of CSS across
    implementations, the CSS Working Group requests that non-experimental
    CSS renderers submit an implementation report (and, if necessary, the
    testcases used for that implementation report) to the W3C before
    releasing an unprefixed implementation of any CSS features. Testcases
    submitted to W3C are subject to review and correction by the CSS
    Working Group.

    <p>Further information on submitting testcases and implementation reports
    can be found from on the CSS Working Group’s website at
    <a href=http://www.w3.org/Style/CSS/Test/>http://www.w3.org/Style/CSS/Test/</a>.
    Questions should be directed to the
    <a href=http://lists.w3.org/Archives/Public/public-css-testsuite>public-css-testsuite@w3.org</a>
    mailing list.

<h2 class="no-num no-ref heading settled heading" id=references><span class=content>
References</span><a class=self-link href=#references></a></h2>

<h3 class="no-num no-ref heading settled heading" id=normative><span class=content>
Normative References</span><a class=self-link href=#normative></a></h3>
<div data-fill-with=normative-references><dl>
<dt id=biblio-2dcontext2 title=2DCONTEXT2><a class=self-link href=#biblio-2dcontext2></a>[2DCONTEXT2]<dd>Rik Cabanier; et al. <a href=http://www.w3.org/TR/2013/WD-2dcontext2-20130528/>HTML Canvas 2D Context, Level 2</a>. 28 May 2013. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2013/WD-2dcontext2-20130528/>http://www.w3.org/TR/2013/WD-2dcontext2-20130528/</a></dd>
<dt id=biblio-css21 title=CSS21><a class=self-link href=#biblio-css21></a>[CSS21]<dd>Bert Bos; et al. <a href=http://www.w3.org/TR/2011/REC-CSS2-20110607>Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</a>. 7 June 2011. W3C Recommendation. URL: <a href=http://www.w3.org/TR/2011/REC-CSS2-20110607>http://www.w3.org/TR/2011/REC-CSS2-20110607</a></dd>
<dt id=biblio-css3bg title=CSS3BG><a class=self-link href=#biblio-css3bg></a>[CSS3BG]<dd>Bert Bos; Elika J. Etemad; Brad Kemper. <a href=http://www.w3.org/TR/2012/CR-css3-background-20120724/>CSS Backgrounds and Borders Module Level 3</a>. 24 July 2012. W3C Candidate Recommendation. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/CR-css3-background-20120724/>http://www.w3.org/TR/2012/CR-css3-background-20120724/</a></dd>
<dt id=biblio-css3color title=CSS3COLOR><a class=self-link href=#biblio-css3color></a>[CSS3COLOR]<dd>Tantek Çelik; Chris Lilley; L. David Baron. <a href=http://www.w3.org/TR/2011/REC-css3-color-20110607>CSS Color Module Level 3</a>. 7 June 2011. W3C Recommendation. URL: <a href=http://www.w3.org/TR/2011/REC-css3-color-20110607>http://www.w3.org/TR/2011/REC-css3-color-20110607</a></dd>
<dt id=biblio-rfc2119 title=RFC2119><a class=self-link href=#biblio-rfc2119></a>[RFC2119]<dd>S. Bradner. <a href=http://www.ietf.org/rfc/rfc2119.txt>Key words for use in RFCs to Indicate Requirement Levels</a>. URL: <a href=http://www.ietf.org/rfc/rfc2119.txt>http://www.ietf.org/rfc/rfc2119.txt</a></dd>
<dt id=biblio-svg11 title=SVG11><a class=self-link href=#biblio-svg11></a>[SVG11]<dd>Erik Dahlström; et al. <a href=http://www.w3.org/TR/2011/REC-SVG11-20110816/>Scalable Vector Graphics (SVG) 1.1 (Second Edition)</a>. 16 August 2011. W3C Recommendation. URL: <a href=http://www.w3.org/TR/2011/REC-SVG11-20110816/>http://www.w3.org/TR/2011/REC-SVG11-20110816/</a></dd>
</dl></div>

<h3 class="no-num no-ref heading settled heading" id=informative><span class=content>
Informative References</span><a class=self-link href=#informative></a></h3>
<div data-fill-with=informative-references><dl>
<dt id=biblio-porterduff title=PORTERDUFF><a class=self-link href=#biblio-porterduff></a>[PORTERDUFF]<dd>Thomas Porter; Tom Duff. <a href=None>Compositing digital images</a>. July 1984. ISSN 0097-8930 URL: <a href=None>None</a></dd>
</dl></div>

<h2 class="no-num no-ref heading settled heading" id=index><span class=content>
Index</span><a class=self-link href=#index></a></h2>
<div data-fill-with=index><ul class=indexlist>
<li>backdrop, <a href=#backdrop0 title="section 7">7</a>
<li>background-blend-mode, <a href=#propdef-background-blend-mode title="section 3.4.3">3.4.3</a>
<li>&lt;blend-mode&gt;, <a href=#ltblendmodegt title="section 3.4.1">3.4.1</a>
<li>color, <a href=#valuedef-color title="section 10.2.3">10.2.3</a>
<li>color-burn, <a href=#valuedef-color-burn title="section 10.1.8">10.1.8</a>
<li>color-dodge, <a href=#valuedef-color-dodge title="section 10.1.7">10.1.7</a>
<li>&lt;composite-mode&gt;, <a href=#ltcompositegt title="section 4">4</a>
<li>darken, <a href=#valuedef-darken title="section 10.1.5">10.1.5</a>
<li>difference, <a href=#valuedef-difference title="section 10.1.11">10.1.11</a>
<li>exclusion, <a href=#valuedef-exclusion title="section 10.1.12">10.1.12</a>
<li>hard-light, <a href=#valuedef-hard-light title="section 10.1.9">10.1.9</a>
<li>hue, <a href=#valuedef-hue title="section 10.2.1">10.2.1</a>
<li>isolation, <a href=#propdef-isolation title="section 3.4.2">3.4.2</a>
<li>&lt;isolation-mode&gt;, <a href=#isolated-propid title="section 3.4.2">3.4.2</a>
<li>lighten, <a href=#valuedef-lighten title="section 10.1.6">10.1.6</a>
<li>luminosity, <a href=#valuedef-luminosity title="section 10.2.4">10.2.4</a>
<li>mix-blend-mode, <a href=#propdef-mix-blend-mode title="section 3.4.1">3.4.1</a>
<li>multiply, <a href=#valuedef-multiply title="section 10.1.2">10.1.2</a>
<li>normal, <a href=#valuedef-normal title="section 10.1.1">10.1.1</a>
<li>overlay, <a href=#valuedef-overlay title="section 10.1.4">10.1.4</a>
<li>saturation, <a href=#valuedef-saturation title="section 10.2.2">10.2.2</a>
<li>screen, <a href=#valuedef-screen title="section 10.1.3">10.1.3</a>
<li>soft-light, <a href=#valuedef-soft-light title="section 10.1.10">10.1.10</a>
</ul></div>

<h2 class="no-num no-ref heading settled heading" id=property-index><span class=content>
Property index</span><a class=self-link href=#property-index></a></h2>
<div data-fill-with=property-index><table class="proptable data"><thead><tr><th scope=col>Name<th scope=col>Value<th scope=col>Initial<th scope=col>Applies to<th scope=col>Inh.<th scope=col>%ages<th scope=col>Media<th scope=col>Animatable<th scope=col>Computed value<tbody>
<tr><th scope=row><a class=css-code data-link-type=property href=#propdef-mix-blend-mode title=mix-blend-mode>mix-blend-mode</a><td>&lt;blend-mode&gt;<td>normal<td>All elements. In SVG, it applies to container elements, graphics elements and graphics referencing elements. [SVG11]<td>no<td>N/A<td>visual<td>no<td>as specified
<tr><th scope=row><a class=css-code data-link-type=property href=#propdef-isolation title=isolation>isolation</a><td>&lt;isolation-mode&gt;<td>auto<td>All elements. In SVG, it applies to container elements, graphics elements and graphics referencing elements. [SVG11]<td>no<td>N/A<td>visual<td>no<td>as specified
<tr><th scope=row><a class=css-code data-link-type=property href=#propdef-background-blend-mode title=background-blend-mode>background-blend-mode</a><td>&lt;blend-mode&gt;<td>normal<td>All HTML elements<td>no<td>N/A<td>visual<td>no<td>as specified</table></div>


</dl>