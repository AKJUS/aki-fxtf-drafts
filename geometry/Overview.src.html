<h1>Geometry Interfaces Module Level 1</h1>
<!-- To the extent possible under law, the editors have waived all copyright and related or neighboring rights to this work. -->
<pre class='metadata'>
Shortname: geometry
Level: 1
Status: ED
ED: http://dev.w3.org/fxtf/geometry/
TR: http://www.w3.org/TR/geometry-1/
Previous Version: http://www.w3.org/TR/2014/WD-geometry-1-20140522/
Group: fxtf
Ignored Terms: float32array, float64array, indexsizeerror, DOMString
Link Defaults: css-transforms-1 (type) <transform-list>/<transform-function>, css-transforms-1 (function) matrix3d()/matrix()
Editor: Simon Pieters, Opera Software ASA, simonp@opera.com
Editor: Dirk Schulze, Adobe Systems Inc., dschulze@adobe.com
Editor: Rik Cabanier, Adobe Systems Inc., cabanier@adobe.com
Abstract: This specification provides basic geometric interfaces to represent points, rectangles, quadrilaterals and transformation matrices that can be used by other modules or specifications.
!Issues list: <a href="https://www.w3.org/Bugs/Public/buglist.cgi?product=FXTF&amp;component=Geometry&amp;resolution=---">Bugzilla</a> (<a href="https://www.w3.org/Bugs/Public/enter_bug.cgi?product=FXTF&amp;component=Geometry">file a bug</a>)
Test Suite: http://test.csswg.org/suites/geometry-1_dev/nightly-unstable/
</pre>

<script src=http://resources.whatwg.org/file-bug.js async></script>
<script src="../shared/MathJax/MathJax.js?config=MML_SVGorMML,local/local"></script>

<style type="text/css">
a[data-link-type=element]::before,span[data-link-type=element]::before {
  content: '<';
}
a[data-link-type=element]::after,span[data-link-type=element]::after {
  content: '>';
}
</style>

<h2 id='intro'>Introduction</h2>

This specification describes several geometry interfaces [[!WEBIDL]] for the representation of points, rectangles, quadrilaterals and transformation matrices with the dimension of 3x2 and 4x4.

The SVG interfaces SVGPoint, SVGRect and SVGMatrix [[SVG11]] are aliasing the here defined interfaces in favor for common interfaces used by SVG, Canvas 2D Context [[2DCONTEXT]] and CSS Transforms [[!CSS3-TRANSFORMS]].

<h2 id='DOMPoint'>
The DOMPoint interfaces</h2>

A 2D point or a 3D point can be represented by the following WebIDL interfaces:

<pre class='idl'>
interface DOMPointReadOnly {
    readonly attribute unrestricted double x;
    readonly attribute unrestricted double y;
    readonly attribute unrestricted double z;
    readonly attribute unrestricted double w;

    DOMPoint matrixTransform(DOMMatrixReadOnly matrix);
};

[Constructor(optional DOMPointInit point),
 Constructor(unrestricted double x, unrestricted double y,
             optional unrestricted double z = 0, optional unrestricted double w = 1)]
interface DOMPoint : DOMPointReadOnly {
    inherit attribute unrestricted double x;
    inherit attribute unrestricted double y;
    inherit attribute unrestricted double z;
    inherit attribute unrestricted double w;
};

dictionary DOMPointInit {
    unrestricted double x = 0;
    unrestricted double y = 0;
    unrestricted double z = 0;
    unrestricted double w = 1;
};
</pre>

<p>The <dfn dfn-type=constructor dfn-for=DOMPoint><code>DOMPoint()</code></dfn> constructor, when invoked, must run the following steps:

<ol>
 <li><p>If invoked with one argument, follow these substeps:
  <ol>
   <li><p>Let <var>point</var> be the argument.
   <li><p>Let <var>x</var> be the <code>x</code> dictionary member of <var>point</var>.
   <li><p>Let <var>y</var> be the <code>y</code> dictionary member of <var>point</var>.
   <li><p>Let <var>z</var> be the <code>z</code> dictionary member of <var>point</var>.
   <li><p>Let <var>w</var> be the <code>w</code> dictionary member of <var>point</var>.
  </ol>
 <li><p>Otherwise, let <var>x</var>, <var>y</var>, <var>z</var> and <var>w</var> be the given arguments, respectively.
 <li><p>Return a new <a interface>DOMPoint</a> object with the <a attribute for=DOMPoint>x</a>, <a attribute for=DOMPoint>y</a>,
 <a attribute for=DOMPoint>z</a> and <a attribute for=DOMPoint>w</a> attributes set to <var>x</var>, <var>y</var>, <var>z</var> and <var>w</var>,
 respectively.
</ol>


<div dfn-type=attribute dfn-for='DOMPointReadOnly DOMPoint'>
 The <dfn>x</dfn> attribute gives the x coordinate of the point. On getting, it must return the current value. On setting, it must set the current value to the new value.

 The <dfn>y</dfn> attribute gives the y coordinate of the point. On getting, it must return the current value. On setting, it must set the current value to the new value.

 The <dfn>z</dfn> attribute gives the z coordinate of the point. On getting, it must return the current value. On setting, it must set the current value to the new value.

 The <dfn>w</dfn> attribute gives the perspective of the point. On getting, it must return the current value. On setting, it must set the current value to the new value.
</div>

The following method does not modify the current <a interface>DOMPointReadOnly</a> object and returns a new <a interface>DOMPoint</a> object.

<dl dfn-type=method dfn-for=DOMPointReadOnly>
  <dt><dfn>matrixTransform(<var>matrix</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Create a new <a interface>DOMPoint</a> <var>point</var> initialized to <a attribute for=DOMPoint>x</a>, <a attribute for=DOMPoint>y</a>, <a attribute for=DOMPoint>z</a> and <a attribute for=DOMPoint>w</a> of the current point.</li>
      <li><i>Post-multiply</i> <var>point</var> with <var>matrix</var>.</li>
      <li>Return <var>point</var>.</li>
    </ol>
    <div class='example'>
      <p>In this example the method <a method>matrixTransform()</a> on <var>point</var> is called with a <a interface>DOMMatrix</a> argument <var>matrix</var>.</p>
      <pre><code>var point = new DOMPoint(5, 4);
var matrix = new DOMMatrix(2, 0, 0, 2, 10, 10);
var transformedPoint = point.matrixTransform(matrix);
      </code></pre>
      <p><var>point</var> creates a new <a interface>DOMPoint</a> object initialized to the same attribute values as <var>point</var>. This new <a interface>DOMPoint</a> is now scaled and the translated by <var>matrix</var>. This resulting <var>transformPoint</var> has the attribute values <code>x: 20</code> and <code>y: 18</code>.</p>
    </div>
  </dd>
</dl>

For historical reasons, Window objects must also have a writable, configurable, non-enumerable property named <code>SVGPoint</code> whose value is the <a interface>DOMPoint</a> interface object.

<h2 id='DOMRect'>
The DOMRect interfaces</h2>

Objects implementing the <a interface>DOMRectReadOnly</a> interface represent a <dfn>rectangle</dfn>. The type of box is specified by the method or attribute that returns a <a interface>DOMRect</a> or <a interface>DOMRectReadOnly</a> object.

Rectangles have the following properties:

<dl dfn-for=rectangle>
  <dt><dfn>origin</dfn></dt>
  <dd>
    When the rectangle has a non-negative <a>width</a>, the rectangle's horizontal origin is the left edge; otherwise, it is the right edge. Similarly, when the rectangle has a non-negative <a>height</a>, the rectangle's vertical origin is the top edge; otherwise, it is the bottom edge.
  </dd>
  <dt><dfn>x coordinate</dfn></dt>
  <dd>
    The horizontal distance between the viewport's left edge and the rectangle's <a>origin</a>.
  </dd>
  <dt><dfn>y coordinate</dfn></dt>
  <dd>
    The vertical distance between the viewport's top edge and the rectangle's <a>origin</a>.
  </dd>
  <dt><dfn>width dimension</dfn></dt>
  <dd>
    The width of the rectangle. Can be negative.
  </dd>
  <dt><dfn>height dimension</dfn></dt>
  <dd>
    The height of the rectangle. Can be negative.
  </dd>
</dl>

<pre class='idl'>
[Constructor(unrestricted double x = 0, unrestricted double y = 0,
             unrestricted double width = 0, unrestricted double height = 0)]
interface DOMRect : DOMRectReadOnly {
    inherit attribute unrestricted double x;
    inherit attribute unrestricted double y;
    inherit attribute unrestricted double width;
    inherit attribute unrestricted double height;
};

[Constructor(unrestricted double x, unrestricted double y,
             unrestricted double width, unrestricted double height)]
interface DOMRectReadOnly {
    readonly attribute unrestricted double x;
    readonly attribute unrestricted double y;
    readonly attribute unrestricted double width;
    readonly attribute unrestricted double height;
    readonly attribute unrestricted double top;
    readonly attribute unrestricted double right;
    readonly attribute unrestricted double bottom;
    readonly attribute unrestricted double left;
};

dictionary DOMRectInit {
    unrestricted double x = 0;
    unrestricted double y = 0;
    unrestricted double width = 0;
    unrestricted double height = 0;
};
</pre>

The following algorithms assume that <a interface>DOMRectReadOnly</a> objects have the internal member variables <a>x coordinate</a>, <a>y coordinate</a>, <a>width dimension</a> and <a>height dimension</a>. <a interface>DOMRectReadOnly</a> as well as the inheriting interface <a interface>DOMRect</a> must be able to access and set the value of these variables.

An interface returning an <a interface>DOMRectReadOnly</a> object by an attribute or function may be able to modify internal member variable values. Such an interface must specify this ability explicitly in prose.

Internal member variables must not be exposed in any way.

The <dfn dfn-type=constructor dfn-for=DOMRect><code>DOMRectReadOnly(<var>x</var>, <var>y</var>, <var>width</var>, <var>height</var>)</code></dfn> constructor, when invoked, must run the following steps:

<ol class="algorithm">
  <li>Set the the current object's variables <a>x coordinate</a> to <var>x</var>, <a>y coordinate</a> to <var>y</var>, <a>width dimension</a> to <var>width</var> and <a>height dimension</a> to <var>height</var>.
  <li>Return the new <a interface>DOMRectReadOnly</a> object.
</ol>

The <dfn dfn-type=constructor dfn-for=DOMRect><code>DOMRect(<var>x</var>, <var>y</var>, <var>width</var>, <var>height</var>)</code></dfn> constructor, when invoked, must run the following steps:

<ol class="algorithm">
  <li>Call the constructor of <a interface>DOMRectReadOnly</a> with <var>x</var>, <var>y</var>, <var>width</var> and <var>height</var>.
  <li>Return the new <a interface>DOMRect</a> object.
</ol>

<div dfn-type=attribute dfn-for='DOMRectReadOnly DOMRect'>
 The <dfn>x</dfn> attribute, on getting, must return the <a>x coordinate</a> value of the object it was invoked. For the <a interface>DOMRect</a> interface, setting the <a attribute for=DOMRect>x</a> attribute must set the <a>x coordinate</a> value of the object it was invoked to the new value.

 The <dfn>y</dfn> attribute, on getting, it must return the <a>y coordinate</a> value of the object it was invoked. For the <a interface>DOMRect</a> interface, setting the <a attribute for=DOMRect>y</a> attribute must set the <a>y coordinate</a> value of the object it was invoked to the new value.

 The <dfn>width</dfn> attribute, on getting, must return the <a>width</a> value of the object it was invoked. For the <a interface>DOMRect</a> interface, setting the <a attribute for=DOMRect>width</a> attribute must set the <a>width dimension</a> value of the object it was invoked to the new value.

 The <dfn>height</dfn> attribute, on getting, must return the <a>height</a> value. For the <a interface>DOMRect</a> interface, setting the <a attribute for=DOMRect>height</a> attribute must set the <a>height dimension</a> value to the new value.

 The <dfn>top</dfn> attribute, on getting, must return min(<a>y coordinate</a>, <a>y coordinate</a> + <a>height dimension</a>) of the object it was invoked.

 The <dfn>right</dfn> attribute, on getting, must return max(<a>x coordinate</a>, <a>x coordinate</a> + <a>width dimension</a>) of the object it was invoked.

 The <dfn>bottom</dfn> attribute, on getting, must return max(<a>y coordinate</a>, <a>y coordinate</a> + <a>height dimension</a>) of the object it was invoked.

 The <dfn>left</dfn> attribute, on getting, must return min(<a>x coordinate</a>, <a>x coordinate</a> + <a>width dimension</a>) of the object it was invoked.
</div>

For historical reasons, Window objects must also have a writable, configurable, non-enumerable property named <code>SVGRect</code> whose value is the <a interface>DOMRect</a> interface object.

<h2 id='DOMRectList'>
The DOMRectList Interface</h2>

<pre class='idl'>
interface DOMRectList {
    readonly attribute unsigned long length;
    getter DOMRect item(unsigned long index);
};
</pre>

The <dfn dfn-type=attribute dfn-for='DOMRectList'>length</dfn> attribute must return the total number of <a interface>DOMRect</a> objects associated with the object.

The <dfn dfn-type=method dfn-for='DOMRectList'>item(<var>index</var>)</dfn> method, when invoked, must throw an <a spec=html5>IndexSizeError</a> exception when <var>index</var> is greater than the number of <a interface>DOMRect</a> objects associated with the object. Otherwise, the <a interface>DOMRect</a> object at <var>index</var> must be returned.

<h2 id='DOMQuad'>
The DOMQuad interface</h2>

Objects implementing the <a interface>DOMQuad</a> interface represents a <dfn>quadrilateral</dfn>.

<pre class='idl'>
[Constructor(optional DOMPointInit p1, optional DOMPointInit p2,
             optional DOMPointInit p3, optional DOMPointInit p4),
 Constructor(optional DOMRectInit rect)]
interface DOMQuad {
    [SameObject] readonly attribute DOMPoint p1;
    [SameObject] readonly attribute DOMPoint p2;
    [SameObject] readonly attribute DOMPoint p3;
    [SameObject] readonly attribute DOMPoint p4;
    [SameObject] readonly attribute DOMRectReadOnly bounds;
};
</pre>

<p>The <dfn dfn-type=constructor dfn-for=DOMQuad><code>DOMQuad()</code></dfn> constructor, when invoked, must run the following steps:

<dl class='switch'>
  <dt>If invoked with one argument:</dt>
  <dd>
    <ol class='algorithm'>
      <li>Let <var>rect</var> be the argument.
      <li>Let <var>x</var>, <var>y</var>, <var>width</var> and <var>height</var> be the value of <var>rect</var>'s <a attribute for=DOMRectReadOnly>x</a>, <a attribute for=DOMRectReadOnly>y</a>, <a attribute for=DOMRectReadOnly>width</a> and <a attribute for=DOMRectReadOnly>height</a> attributes, respectively.
      <li>Let <var>point 1</var> be a new <a interface>DOMPoint</a> object with <a attribute for=DOMPoint>x</a> set to <var>x</var>, <a attribute for=DOMPoint>y</a> set to <var>y</var>, <a attribute for=DOMPoint>z</a> set to zero and <a attribute for=DOMPoint>w</a> set to one.
      <li>Let <var>point 2</var> be a new <a interface>DOMPoint</a> object with <a attribute for=DOMPoint>x</a> set to <var>x</var> + <var>width</var>, <a attribute for=DOMPoint>y</a> set to <var>y</var>, <a attribute for=DOMPoint>z</a> set to zero and <a attribute for=DOMPoint>w</a> set to one.
      <li>Let <var>point 3</var> be a new <a interface>DOMPoint</a> object with <a attribute for=DOMPoint>x</a> set to <var>x</var> + <var>width</var>, <a attribute for=DOMPoint>y</a> set to <var>y</var> + <var>height</var>, <a attribute for=DOMPoint>z</a> set to zero and <a attribute for=DOMPoint>w</a> set to one.
      <li>Let <var>point 4</var> be a new <a interface>DOMPoint</a> object with <a attribute for=DOMPoint>x</a> set to <var>x</var>, <a attribute for=DOMPoint>y</a> set to <var>y</var> + <var>height</var>, <a attribute for=DOMPoint>z</a> set to zero and <a attribute for=DOMPoint>w</a> set to one.
      <li><p>Return a new <a interface>DOMQuad</a> with <a attribute for=DOMQuad>p1</a> set to <var>point 1</var>, <a attribute for=DOMQuad>p2</a> set to <var>point 2</var>, <a attribute for=DOMQuad>p3</a> set to <var>point 3</var> and <a attribute for=DOMQuad>p4</a> set to <var>point 4</var>, and let the <a>associated bounding rectangle</a> be <var>bounds</var>.
    </ol>
  </dd>
  <dt>Otherwise:</dt>
  <dd>
    <ol class='algorithm'>
      <li>Let <var>p1</var>, <var>p2</var>, <var>p3</var> and <var>p4</var> be the given arguments, in the same order.
      <li>Let <var>point 1</var> be a new <a interface>DOMPoint</a> object with its attributes set to the values of the namesake dictionary members in <var>p1</var>.
      <li>Let <var>point 2</var> be a new <a interface>DOMPoint</a> object with its attributes set to the values of the namesake dictionary members in <var>p2</var>.
      <li>Let <var>point 3</var> be a new <a interface>DOMPoint</a> object with its attributes set to the values of the namesake dictionary members in <var>p3</var>.
      <li>Let <var>point 4</var> be a new <a interface>DOMPoint</a> object with its attributes set to the values of the namesake dictionary members in <var>p4</var>.
      <li><p>Return a new <a interface>DOMQuad</a> with <a attribute for=DOMQuad>p1</a> set to <var>point 1</var>, <a attribute for=DOMQuad>p2</a> set to <var>point 2</var>, <a attribute for=DOMQuad>p3</a> set to <var>point 3</var> and <a attribute for=DOMQuad>p4</a> set to <var>point 4</var>, and let the <a>associated bounding rectangle</a> be <var>bounds</var>.
    </ol>
    <p class='note'>Note: It is possible to pass <a interface>DOMPoint</a>/<a interface>DOMPointReadOnly</a> arguments as well. The passed arguments will be transformed to the correct object type internally following the WebIDL rules [[!WEBIDL]].
  </dd>
</dl>

<div dfn-type=attribute dfn-for=DOMQuad>
 The <dfn>p1</dfn> attribute must return a <a interface>DOMPoint</a> that represents <a attribute>p1</a> of the quadrilateral it was invoked. The author can modify the returned <a interface>DOMPoint</a> object, which has direct affect on the quadrilateral.

 The <dfn>p2</dfn> attribute must return a <a interface>DOMPoint</a> that represents <a attribute>p2</a> of the quadrilateral it was invoked. The author can modify the returned <a interface>DOMPoint</a> object, which has direct affect on the quadrilateral.

 The <dfn>p3</dfn> attribute must return a <a interface>DOMPoint</a> that represents <a attribute>p3</a> of the quadrilateral it was invoked. The author can modify the returned <a interface>DOMPoint</a> object, which has direct affect on the quadrilateral.

 The <dfn>p4</dfn> attribute must return a <a interface>DOMPoint</a> that represents <a attribute>p4</a> of the quadrilateral it was invoked. The author can modify the returned <a interface>DOMPoint</a> object, which has direct affect on the quadrilateral.

 The <dfn>bounds</dfn> attribute must return the <a>associated bounding rectangle</a> of the quadrilateral it was invoked.
</div>

<a interface>DOMQuad</a> objects have an <dfn for=quadlirateral>associated bounding rectangle</dfn> set to a <a interface>DOMRectReadOnly</a> object when created. <a interface>DOMQuad</a> objects must have read and write access to the internal member variables of the <a>associated bounding rectangle</a>. The <a>associated bounding rectangle</a> is live; whenever the objects for <a attribute>p1</a>, <a attribute>p2</a>, <a attribute>p3</a> or <a attribute>p4</a> change, the <a>associated bounding rectangle</a> must update its internal member variable values as appropriate to describe the new smallest bounding box of the four points.

The <a>associated bounding rectangle</a> is computed as follows:
<ol class='algorithm'>
  <li>Let <var>bounds</var> be a <a interface>DOMRectReadOnly</a> object.</li>
  <li>Let <var>left</var> be the minimum of <a attribute>p1</a>.x, <a attribute>p2</a>.x, <a attribute>p3</a>.x and <a attribute>p4</a>.x.</li>
  <li>Let <var>top</var> be the minimum of <a attribute>p1</a>.y, <a attribute>p2</a>.y, <a attribute>p3</a>.y and <a attribute>p4</a>.y.</li>
  <li>Let <var>right</var> be the maximum of <a attribute>p1</a>.x, <a attribute>p2</a>.x, <a attribute>p3</a>.x and <a attribute>p4</a>.x.</li>
  <li>Let <var>bottom</var> be the maximum of <a attribute>p1</a>.y, <a attribute>p2</a>.y, <a attribute>p3</a>.y and <a attribute>p4</a>.y.</li>
  <li>Let <a>x coordinate</a> of <var>bounds</var> be <var>left</var>, <a>y coordinate</a> of <var>bounds</var> be <var>top</var>, <a>width dimension</a> of <var>bounds</var> be <var>right</var> - <var>left</var> and <a>height dimension</a> of <var>bounds</var> be <var>bottom</var> - <var>top</var>.</li>
</ol>

<div class='example'>
<p>In this example the <a interface>DOMQuad</a> constructor is called with arguments of type <a interface>DOMPoint</a> and <a dictionary>DOMPointInit</a>. Both arguments are accepted and can be used.
<pre><code>var point = new DOMPoint(2, 0);
var quad1 = new DOMQuad(point, {x: 12, y: 0}, {x: 2, y: 10}, {x: 12, 10});</code></pre>
<p>The attribute values of the resulting <a interface>DOMQuad</a> <var>quad1</var> above are also equal to the attribute values of the following <a interface>DOMQuad</a> <var>quad2</var>:</p>
<pre><code>var rect = new DOMRect(2, 0, 10, 10);
var quad2 = new DOMQuad(rect);</code></pre>
</div>
<div class='example'>
<p>This is an example of an irregular quadrilateral:</p>
<pre><code>new DOMQuad({x: 40, y: 25}, {x: 180, y: 8}, {x: 210, y: 150}, {x: 10, y: 180});
</code></pre>
<div class="figure">
  <svg width="230" height="200">
    <title>An irregular quadrilateral with none of the sides being vertical or horizontal. Its four corners are marked with red circles. Around this quadrilateral is a dashed rectangle. All sides of this rectangle are vertical or horizontal and tangent the quadrilateral.</title>
    <polygon points="40 25, 180 8, 210 150, 10 180" fill="rgb(51, 153, 204)"/>
    <rect x="10" y="8" width="200" height="172" fill="none" stroke="black" stroke-dasharray="3 2"/>
    <circle cx="40" cy="25" r="3" fill="rgb(204, 51, 51)"/>
    <circle cx="180" cy="8" r="3" fill="rgb(204, 51, 51)"/>
    <circle cx="210" cy="150" r="3" fill="rgb(204, 51, 51)"/>
    <circle cx="10" cy="180" r="3" fill="rgb(204, 51, 51)"/>
  </svg>
  <p class="capture">An irregular quadrilateral represented by a <a interface>DOMQuad</a>. The four red colored circles represent the <a interface>DOMPoint</a> attributes <a attribute>p1</a> to <a attribute>p4</a>. The dashed rectangle represents the <a>associated bounding rectangle</a> <a attribute>bounds</a> of the <a interface>DOMQuad</a>.</p>
</div>
</div>

<h2 id='DOMMatrix'>
The DOMMatrix interfaces</h2>

The <a interface>DOMMatrix</a> and <a interface>DOMMatrixReadOnly</a> interfaces represent a mathematical matrix with the purpose of describing transformations in a graphical context. The following sections describe the details of the interface.

The <a interface>DOMMatrix</a> and <a interface>DOMMatrixReadOnly</a>  interfaces replace the SVGMatrix interface from SVG [[SVG11]].

For legacy reasons, if the user agent supports SVG, <a interface>Window</a> objects must have a writable, configurable, non-enumerable property named <dfn>SVGMatrix</dfn> whose value is the <a interface>DOMMatrix</a> interface object. [[SVG11]]

<div class="figure">
  <!--<img src="images/4x4matrix.png" alt="4x4 matrix with items m11 to m44">-->
  <math display=block><mrow><mfenced open=[ close=] separators=,><mrow><mtable><mtr><mtd><msub><mi>m</mi><mi>11</mi></msub></mtd><mtd><msub><mi>m</mi><mi>21</mi></msub></mtd><mtd><msub><mi>m</mi><mi>31</mi></msub></mtd><mtd><msub><mi>m</mi><mi>41</mi></msub></mtd></mtr><mtr><mtd><msub><mi>m</mi><mi>12</mi></msub></mtd><mtd><msub><mi>m</mi><mi>22</mi></msub></mtd><mtd><msub><mi>m</mi><mi>32</mi></msub></mtd><mtd><msub><mi>m</mi><mi>42</mi></msub></mtd></mtr><mtr><mtd><msub><mi>m</mi><mi>13</mi></msub></mtd><mtd><msub><mi>m</mi><mi>23</mi></msub></mtd><mtd><msub><mi>m</mi><mi>33</mi></msub></mtd><mtd><msub><mi>m</mi><mi>43</mi></msub></mtd></mtr><mtr><mtd><msub><mi>m</mi><mi>14</mi></msub></mtd><mtd><msub><mi>m</mi><mi>24</mi></msub></mtd><mtd><msub><mi>m</mi><mi>34</mi></msub></mtd><mtd><msub><mi>m</mi><mi>44</mi></msub></mtd></mtr></mtable></mrow></mfenced></mrow></math>
  <p class="capture">A 4x4 matrix representing a <a interface>DOMMatrix</a> with items m11 to m44.</p>
</div>

In the following sections, terms have the following meaning:

<dl>
  <dt><dfn>post-multiply</dfn></dt>
  <dd>
    Term A post-multiplied by term B is equal to A &middot; B.
  </dd>
  <dt><dfn>pre-multiply</dfn></dt>
  <dd>
    Term A pre-multiplied by term B is equal to B &middot; A.
  </dd>
  <dt><dfn>multiply</dfn></dt>
  <dd>
    Multiply term A by term B is equal to A &middot; B.
  </dd>
</dl>

<pre class='idl'>
interface DOMMatrixReadOnly {
    // These attributes are simple aliases for certain elements of the 4x4 matrix
    readonly attribute unrestricted double a;
    readonly attribute unrestricted double b;
    readonly attribute unrestricted double c;
    readonly attribute unrestricted double d;
    readonly attribute unrestricted double e;
    readonly attribute unrestricted double f;

    readonly attribute unrestricted double m11;
    readonly attribute unrestricted double m12;
    readonly attribute unrestricted double m13;
    readonly attribute unrestricted double m14;
    readonly attribute unrestricted double m21;
    readonly attribute unrestricted double m22;
    readonly attribute unrestricted double m23;
    readonly attribute unrestricted double m24;
    readonly attribute unrestricted double m31;
    readonly attribute unrestricted double m32;
    readonly attribute unrestricted double m33;
    readonly attribute unrestricted double m34;
    readonly attribute unrestricted double m41;
    readonly attribute unrestricted double m42;
    readonly attribute unrestricted double m43;
    readonly attribute unrestricted double m44;

    readonly attribute boolean is2D;
    readonly attribute boolean isIdentity;

    // Immutable transform methods
    DOMMatrix translate(unrestricted double tx,
                        unrestricted double ty,
                        optional unrestricted double tz = 0);
    DOMMatrix scale(unrestricted double scale,
                    optional unrestricted double originX = 0,
                    optional unrestricted double originY = 0);
    DOMMatrix scale3d(unrestricted double scale,
                      optional unrestricted double originX = 0,
                      optional unrestricted double originY = 0,
                      optional unrestricted double originZ = 0);
    DOMMatrix scaleNonUniform(unrestricted double scaleX,
                              optional unrestricted double scaleY = 1,
                              optional unrestricted double scaleZ = 1,
                              optional unrestricted double originX = 0,
                              optional unrestricted double originY = 0,
                              optional unrestricted double originZ = 0);
    DOMMatrix rotate(unrestricted double angle,
                     optional unrestricted double originX = 0,
                     optional unrestricted double originY = 0);
    DOMMatrix rotateFromVector(unrestricted double x,
                               unrestricted double y);
    DOMMatrix rotateAxisAngle(unrestricted double x,
                              unrestricted double y,
                              unrestricted double z,
                              unrestricted double angle);
    DOMMatrix skewX(unrestricted double sx);
    DOMMatrix skewY(unrestricted double sy);
    DOMMatrix multiply(DOMMatrix other);
    DOMMatrix flipX();
    DOMMatrix flipY();
    DOMMatrix inverse();

    DOMPoint            transformPoint(optional DOMPointInit point);
    Float32Array        toFloat32Array();
    Float64Array        toFloat64Array();
                        stringifier;
};

[Constructor,
 Constructor(DOMString transformList),
 Constructor(DOMMatrixReadOnly other),
 Constructor(Float32Array array32),
 Constructor(Float64Array array64),
 Constructor(sequence&lt;unrestricted double> numberSequence)]
interface DOMMatrix : DOMMatrixReadOnly {
    // These attributes are simple aliases for certain elements of the 4x4 matrix
    inherit attribute unrestricted double a;
    inherit attribute unrestricted double b;
    inherit attribute unrestricted double c;
    inherit attribute unrestricted double d;
    inherit attribute unrestricted double e;
    inherit attribute unrestricted double f;

    inherit attribute unrestricted double m11;
    inherit attribute unrestricted double m12;
    inherit attribute unrestricted double m13;
    inherit attribute unrestricted double m14;
    inherit attribute unrestricted double m21;
    inherit attribute unrestricted double m22;
    inherit attribute unrestricted double m23;
    inherit attribute unrestricted double m24;
    inherit attribute unrestricted double m31;
    inherit attribute unrestricted double m32;
    inherit attribute unrestricted double m33;
    inherit attribute unrestricted double m34;
    inherit attribute unrestricted double m41;
    inherit attribute unrestricted double m42;
    inherit attribute unrestricted double m43;
    inherit attribute unrestricted double m44;

    // Mutable transform methods
    DOMMatrix multiplySelf(DOMMatrix other);
    DOMMatrix preMultiplySelf(DOMMatrix other);
    DOMMatrix translateSelf(unrestricted double tx,
                     unrestricted double ty,
                     optional unrestricted double tz = 0);
    DOMMatrix scaleSelf(unrestricted double scale,
                 optional unrestricted double originX = 0,
                 optional unrestricted double originY = 0);
    DOMMatrix scale3dSelf(unrestricted double scale,
                   optional unrestricted double originX = 0,
                   optional unrestricted double originY = 0,
                   optional unrestricted double originZ = 0);
    DOMMatrix scaleNonUniformSelf(unrestricted double scaleX,
                           optional unrestricted double scaleY = 1,
                           optional unrestricted double scaleZ = 1,
                           optional unrestricted double originX = 0,
                           optional unrestricted double originY = 0,
                           optional unrestricted double originZ = 0);
    DOMMatrix rotateSelf(unrestricted double angle,
                  optional unrestricted double originX = 0,
                  optional unrestricted double originY = 0);
    DOMMatrix rotateFromVectorSelf(unrestricted double x,
                            unrestricted double y);
    DOMMatrix rotateAxisAngleSelf(unrestricted double x,
                           unrestricted double y,
                           unrestricted double z,
                           unrestricted double angle);
    DOMMatrix skewXSelf(unrestricted double sx);
    DOMMatrix skewYSelf(unrestricted double sy);
    DOMMatrix invertSelf();

    DOMMatrix setMatrixValue(DOMString transformList);
};
</pre>

For historical reasons, Window objects must also have a writable, configurable, non-enumerable property named <code>SVGMatrix</code> whose value is the <a interface>DOMMatrix</a> interface object.

<h3 id='dommatrix-constructors'>DOMMatrix constructors</h3>

The <dfn dfn-type=constructor dfn-for=DOMMatrix><code>DOMMatrix()</code></dfn> constructor, when invoked, must run the following steps:

<ol>
  <li>If invoked with no arguments:
    <ol>
      <li>set the <a attribute>m12</a>, <a attribute>m13</a>, <a attribute>m14</a>, <a attribute>m21</a>, <a attribute>m23</a>, <a attribute>m24</a>, <a attribute>m31</a>, <a attribute>m32</a>, <a attribute>m34</a>, <a attribute>m41</a>, <a attribute>m42</a>, <a attribute>m43</a> attributes to ''0'' and the <a attribute>m11</a>, <a attribute>m22</a>, <a attribute>m33</a>, <a attribute>m44</a> attributes to ''1''.</li>
      <li>Set <a>is2D</a> to ''true''.</li>
    </ol>
  </li>
  <li>If invoked with a <a interface>DOMString</a> argument <var>transformList</var>:
    <ol>
      <li>Parse <var>transformList</var> by following the syntax description in “<a href=http://www.w3.org/TR/css-transforms-1/#svg-syntax>Syntax of the SVG ‘transform’ attribute</a>” [[!CSS3-TRANSFORMS]] to a <<transform-list>>. If parsing is not successful or any <<transform-function>> has <<length>> values without <a spec='css-values'>absolute length</a> units<!--For WD: <a spec='css-values-3'>absolute length units</a>-->, throw an <a spec=html5>SyntaxError</a> exception.</li>
      <li>Set <a>is2D</a> to ''false'' if the <<transform-list>> consists of any <a href='http://www.w3.org/TR/css-transforms-1/#three-d-transform-functions'>3D Transform functions</a>. Otherwise set <a>is2D</a> to ''true''.</li>
      <li>Transform all <<transform-function>>s to 4x4 matrices by following the “<a href=http://www.w3.org/TR/css-transforms-1/#mathematical-description>Mathematical Description of Transform Functions</a>” [[!CSS3-TRANSFORMS]].</li>
      <li>Post-multiply all matrices from left to right to a combined 4x4 matrix.</li>
      <li>Set the <a attribute>m11</a> to <a attribute>m44</a> attributes to the element values of the 4x4 matrix in column-major order.</li>
    </ol>
  </li>
  <li>If invoked with a <a interface>DOMMatrixReadOnly</a> argument <var>other</var>:
    <ol>
      <li>Set <a attribute>m11</a> to <a attribute>m44</a> attributes to the corresponding attribute values of <var>other</var>.</li>
      <li>Set <a>is2D</a> to the corresponding flag of <var>other</var>.</li>
    </ol>
  </li>
  <li>If invoked with a <a interface>Float32Array</a> argument <var>array32</var>:
    <ul>
      <li>If <var>array32</var> has 6 elements set <a attribute>a</a>, <a attribute>b</a>, <a attribute>c</a>, <a attribute>d</a>, <a attribute>e</a>, <a attribute>f</a> to the element values of <var>array32</var> in element order starting with the first element. Furthermore, set <a attribute>m31</a>, <a attribute>m32</a>, <a attribute>m13</a>, <a attribute>m23</a>, <a attribute>m43</a>, <a attribute>m14</a>, <a attribute>m24</a>, <a attribute>m34</a> to ''0'' and <a attribute>m33</a>, <a attribute>m44</a> to ''1''. Set <a>is2D</a> to ''true''.</li>
      <li>If <var>array32</var> has 16 elements set <a attribute>m11</a> to <a attribute>m44</a> to the element values of <var>array32</var> in column-major order. Set <a>is2D</a> to ''false''.</li>
      <li>Otherwise throw an <a spec=html5>IndexSizeError</a> exception.</li>
    </ul>
  </li>
  <li>If invoked with a <a interface>Float64Array</a> argument <var>array64</var>:
    <ul>
      <li>If <var>array64</var> has 6 elements set <a attribute>a</a>, <a attribute>b</a>, <a attribute>c</a>, <a attribute>d</a>, <a attribute>e</a>, <a attribute>f</a> to the element values of <var>array64</var> in element order starting with the first element. Furthermore, set <a attribute>m31</a>, <a attribute>m32</a>, <a attribute>m13</a>, <a attribute>m23</a>, <a attribute>m43</a>, <a attribute>m14</a>, <a attribute>m24</a>, <a attribute>m34</a> to ''0'' and <a attribute>m33</a>, <a attribute>m44</a> to ''1''. Set <a>is2D</a> to ''true''.</li>
      <li>If <var>array64</var> has 16 elements set <a attribute>m11</a> to <a attribute>m44</a> to the element values of <var>array64</var> in column-major order. Set <a>is2D</a> to ''false''.</li>
      <li>Otherwise throw an <a spec=html5>IndexSizeError</a> exception.</li>
    </ul>
  </li>
  <li>If invoked with a sequence&lt;unrestricted double> argument <var>numberSequence</var>:
    <ul>
      <li>If <var>numberSequence</var> has 6 elements set <a attribute>a</a>, <a attribute>b</a>, <a attribute>c</a>, <a attribute>d</a>, <a attribute>e</a>, <a attribute>f</a> to the element values of <var>numberSequence</var> in element order starting with the first element. Furthermore, set <a attribute>m31</a>, <a attribute>m32</a>, <a attribute>m13</a>, <a attribute>m23</a>, <a attribute>m43</a>, <a attribute>m14</a>, <a attribute>m24</a>, <a attribute>m34</a> to ''0'' and <a attribute>m33</a>, <a attribute>m44</a> to ''1''. Set <a>is2D</a> to ''true''.</li>
      <li>If <var>numberSequence</var> has 16 elements set <a attribute>m11</a> to <a attribute>m44</a> to the element values of <var>numberSequence</var> in column-major order. Set <a>is2D</a> to ''false''.</li>
      <li>Otherwise throw an <a spec=html5>IndexSizeError</a> exception.</li>
    </ul>
  </li>
</ol>

<h3 id='dommatrix-attributes'>DOMMatrix attributes</h3>

The following attributes <a attribute>m11</a> to <a attribute>m44</a> correspond to the 16 items of the matrix interfaces. If the attributes <a attribute>m31</a>, <a attribute>m32</a>, <a attribute>m13</a>, <a attribute>m23</a>, <a attribute>m43</a>, <a attribute>m14</a>, <a attribute>m24</a>, <a attribute>m34</a> are set to something else than ''0'' or <a attribute>m33</a>, <a attribute>m44</a> are set to something else than ''1'' set <a>is2D</a> to ''false''.


<dl dfn-type=attribute dfn-for='DOMMatrix DOMMatrixReadOnly'>
  <dt><dfn>m11</dfn></dt>
  <dd>
    The value of the element in column 1, row 1 of the matrix.
  </dd>
  <dt><dfn>m12</dfn></dt>
  <dd>
    The value of the element in column 1, row 2 of the matrix.
  </dd>
  <dt><dfn>m13</dfn></dt>
  <dd>
    The value of the element in column 1, row 3 of the matrix.
  </dd>
  <dt><dfn>m14</dfn></dt>
  <dd>
    The value of the element in column 1, row 4 of the matrix.
  </dd>
  <dt><dfn>m21</dfn></dt>
  <dd>
    The value of the element in column 2, row 1 of the matrix.
  </dd>
  <dt><dfn>m22</dfn></dt>
  <dd>
    The value of the element in column 2, row 2 of the matrix.
  </dd>
  <dt><dfn>m23</dfn></dt>
  <dd>
    The value of the element in column 2, row 3 of the matrix.
  </dd>
  <dt><dfn>m24</dfn></dt>
  <dd>
    The value of the element in column 2, row 4 of the matrix.
  </dd>
  <dt><dfn>m31</dfn></dt>
  <dd>
    The value of the element in column 3, row 1 of the matrix.
  </dd>
  <dt><dfn>m32</dfn></dt>
  <dd>
    The value of the element in column 3, row 2 of the matrix.
  </dd>
  <dt><dfn>m33</dfn></dt>
  <dd>
    The value of the element in column 3, row 3 of the matrix.
  </dd>
  <dt><dfn>m34</dfn></dt>
  <dd>
    The value of the element in column 3, row 4 of the matrix.
  </dd>
  <dt><dfn>m41</dfn></dt>
  <dd>
    The value of the element in column 4, row 1 of the matrix.
  </dd>
  <dt><dfn>m42</dfn></dt>
  <dd>
    The value of the element in column 4, row 2 of the matrix.
  </dd>
  <dt><dfn>m43</dfn></dt>
  <dd>
    The value of the element in column 4, row 3 of the matrix.
  </dd>
  <dt><dfn>m44</dfn></dt>
  <dd>
    The value of the element in column 4, row 4 of the matrix.
  </dd>
</dl>

The following attributes <a attribute>a</a> to <a attribute>b</a> correspond to the 2D components of the matrix interfaces.

<dl dfn-type=attribute dfn-for='DOMMatrix DOMMatrixReadOnly'>
  <dt><dfn>a</dfn></dt>
  <dd>
    Corresponds to the attribute <a attribute>m11</a>.
  </dd>
  <dt><dfn>b</dfn></dt>
  <dd>
    Corresponds to the attribute <a attribute>m12</a>.
  </dd>
  <dt><dfn>c</dfn></dt>
  <dd>
    Corresponds to the attribute <a attribute>m21</a>.
  </dd>
  <dt><dfn>d</dfn></dt>
  <dd>
    Corresponds to the attribute <a attribute>m22</a>.
  </dd>
  <dt><dfn>e</dfn></dt>
  <dd>
    Corresponds to the attribute <a attribute>m41</a>.
  </dd>
  <dt><dfn>f</dfn></dt>
  <dd>
    Corresponds to the attribute <a attribute>m42</a>.
  </dd>
</dl>

The following attribute provide status information about <a interface>DOMMatrixReadOnly</a>.

<dl dfn-type=attribute dfn-for=DOMMatrixReadOnly>
  <dt><dfn>is2D</dfn></dt>
  <dd>
    <p>Every <a interface>DOMMatrixReadOnly</a> object must be flagged with a boolean <dfn dfn-type=dfn>is2D</dfn>. This flag indicates that
      <ol>
        <li>The current matrix was initialized as a 2D matrix. See individual <a href="#dommatrix-constructors">constructors</a> for more details.</li>
        <li>Only 2D transformation operations were applied. Each <a href='#mutable-transformation-methods'>mutable</a> or <a href='#immutable-transformation-methods'>immutable transformation method</a> defines if <a>is2D</a> must be set to ''false''.</li>
      </ol>
    </p>
    <p class='note'><a>is2D</a> can never be set to ''true'' when it was set to ''false'' before on a <a interface>DOMMatrix</a> object with the exception of calling the <a>setMatrixValue()</a> method.</p>
    <p>Returns the value of <a>is2D</a>.</p>
  </dd>
  <dt><dfn>isIdentity</dfn></dt>
  <dd>
    Returns ''true'' if <a attribute>m12</a>, <a attribute>m13</a>, <a attribute>m14</a>, <a attribute>m21</a>, <a attribute>m23</a>, <a attribute>m24</a>, <a attribute>m31</a>, <a attribute>m32</a>, <a attribute>m34</a>, <a attribute>m41</a>, <a attribute>m42</a>, <a attribute>m43</a> are ''0'' and <a attribute>m11</a>, <a attribute>m22</a>, <a attribute>m33</a>, <a attribute>m44</a> are ''1''. Otherwise returns ''false''.
  </dd>
</dl>

<h3 id='immutable-transformation-methods'>Immutable transformation methods</h3>

The following methods do not modify the current matrix and return a new <a interface>DOMMatrix</a> object.

<dl dfn-type=method dfn-for=DOMMatrixReadOnly>
  <dt><dfn>translate(<var>tx</var>, <var>ty</var>, <var>tz</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Perform a <a method>translateSelf()</a> transformation on <em>result</em> with the arguments <var>tx</var>, <var>ty</var>, <var>tz</var>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>scale(<var>scale</var>, <var>originX</var>, <var>originY</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>other</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Perform a <a method>scaleSelf()</a> transformation on <em>result</em> with the arguments <var>scale</var>, <var>originX</var>, <var>originY</var>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>scale3d(<var>scale</var>, <var>originX</var>, <var>originY</var>, <var>originZ</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Perform a <a method>scale3dSelf()</a> transformation on <em>result</em> with the arguments <var>scale</var>, <var>originX</var>, <var>originY</var>, <var>originZ</var>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>scaleNonUniform(<var>scaleX</var>, <var>scaleY</var>, <var>scaleZ</var>, <var>originX</var>, <var>originY</var>, <var>originZ</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Perform a <a method>scaleNonUniformSelf()</a> transformation on <em>result</em> with the arguments <var>scaleX</var>, <var>scaleY</var>, <var>scaleZ</var>, <var>originX</var>, <var>originY</var>, <var>originZ</var>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>rotate(<var>angle</var>, <var>originX</var>, <var>originY</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Perform a <a method>rotateSelf()</a> transformation on <em>result</em> with the arguments <var>angle</var>, <var>originX</var>, <var>originY</var>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>rotateFromVector(<var>x</var>, <var>y</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Perform a <a method>rotateFromVectorSelf()</a> transformation on <em>result</em> with the arguments <var>x</var>, <var>y</var>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>rotateAxisAngle(<var>x</var>, <var>y</var>, <var>z</var>, <var>angle</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Perform a <a method>rotateAxisAngleSelf()</a> transformation on <em>result</em> with the arguments <var>x</var>, <var>y</var>, <var>z</var>, <var>angle</var>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>skewX(<var>sx</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Perform a <a method>skewXSelf()</a> transformation on <em>result</em> with the argument <var>sx</var>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>skewY(<var>sy</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Perform a <a method>skewYSelf()</a> transformation on <em>result</em> with the argument <var>sy</var>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>multiply(<var>other</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Perform a <a method>multiply()</a> transformation on <em>result</em> with the argument <var>other</var>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>flipX()</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Post-multiply <em>result</em> with <code>DOMMatrix(-1, 0, 0, 1, 0, 0)</code>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>flipY()</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Post-multiply <em>result</em> with <code>DOMMatrix(1, 0, 0, -1, 0, 0)</code>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
  <dt><dfn>inverse()</dfn></dt>
  <dd>
    <ol>
      <li>Let <em>result</em> be the resulting matrix initialized to the values of the current matrix.</li>
      <li>Perform a <a method>invertSelf()</a> transformation on <em>result</em>.</li>
      <li>Return <em>result</em>.</li>
    </ol>
    <p>The current matrix is not modified.</p>
  </dd>
</dl>

The following methods do not modify the current matrix.

<dl dfn-type=method dfn-for=DOMMatrixReadOnly>
  <dt><dfn>transformPoint(<var>point</var>)</dfn></dt>
  <dd>
    The point argument is post-multiplied to the current matrix and returns the resulting point. The passed argument does not get modified.
    <p class='note'>Note: Even though <a attribute>is2D</a> of the current matrix may return ''true'', a 4x4 matrix mutliplication must be performed if the <a attribute>z</a> attribute of <var>point</var> is not ''0'' or the <a attribute>w</a> attribute of <var>point</var> is not ''1''.</p>
  </dd>
  <dt><dfn>toFloat32Array()</dfn></dt>
  <dd>
    Returns the serialized 16 elements <a attribute>m11</a> to <a attribute>m44</a> of the current matrix in column-major order as <a interface>Float32Array</a> [[typedarray]].
  </dd>
  <dt><dfn>toFloat64Array()</dfn></dt>
  <dd>
    Returns the serialized 16 elements <a attribute>m11</a> to <a attribute>m44</a> of the current matrix in column-major order as <a interface>Float64Array</a> [[typedarray]].
  </dd>
  <dt><dfn>stringifier()</dfn></dt>
  <dd>
    <dl class=switch>
      <dt>If <a>is2D</a> is ''true''</dt>
      <dd>
        Return a DOMString in the form of a CSS Transforms <<matrix()>> function where <var>a</var> is <a attribute>a</a> attribute, <var>b</var> is <a attribute>b</a> attribute, <var>c</var> is <a attribute>c</a> attribute, <var>d</var> is <a attribute>d</a> attribute, <var>e</var> is <a attribute>e</a> attribute, <var>f</var> is <a attribute>f</a> attribute, [[!CSS3-TRANSFORMS]].</li>
      </dd>
      <dt>Otherwise</dt>
      <dd>
        Return a DOMString in the form of a CSS Transforms <<matrix3d()>> function where <var>m11</var> to <var>m44</var> are set to <a attribute>m11</a> to <a attribute>m44</a> attributes [[!CSS3-TRANSFORMS]].
      </dd>
    </dl>
    <div class='example'>
      <p>In this example a matrix is created and several methods with 2D transformations are called.</p>
      <pre><code>var matrix = new DOMMatrix();
matrix.scaleSelf(2);
matrix.translateSelf(20,20);</code></pre>
      <p>Calling <code>matrix.toString()</code> returns the DOMString:</p>
      <pre><code>"matrix(2, 0, 0, 2, 20, 20)"</code></pre>
      <p>For 3D operations, the <var>stringifier</var> returns a DOMString representing a 3D matrix.</p>
      <pre><code>var matrix = new DOMMatrix();
matrix.scale3dSelf(2);</code></pre>
      <p>Calling <code>matrix.toString()</code> after the snippet above returns the DOMString:</p>
      <pre><code>"matrix3d(2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 1)"</code></pre>
    </div>
  </dd>
</dl>

<h3 id='mutable-transformation-methods'>Mutable transformation methods</h3>

The following methods do modify the current matrix. Each method returns the current matrix the method was called on. This allows authors to chain method calls.

<div class='example'>
<p>The following code example</p>

<pre><code>var matrix = new DOMMatrix();
matrix.translateSelf(20, 20);
matrix.scaleSelf(2);
matrix.translateSelf(-20, -20);
</code></pre>

<p>is equivalent to</p>

<pre><code>var matrix = new DOMMatrix();
matrix.translateSelf(20, 20).scaleSelf(2).translateSelf(-20, -20);
</code></pre>
</div>

Note: Authors who use chained method calls are recommended to use mutable transformation methods to avoid unnecessary memory allocations due to intermediate DOMMatrix creations in User Agents.

<dl dfn-type=method dfn-for=DOMMatrix>
  <dt><dfn>multiplySelf(<var>other</var>)</dfn></dt>
  <dd>
    <ol>
      <li>The <em>other</em> matrix gets post-multiplied to the current matrix.</li>
      <li>If <a>is2D</a> of <em>other</em> is ''false'', set <a>is2D</a> of the current matrix to ''false''.</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>preMultiplySelf(<var>other</var>)</dfn></dt>
  <dd>
    <ol>
      <li>The <em>other</em> matrix gets pre-multiplied to the current matrix.</li>
      <li>If <a>is2D</a> of <em>other</em> is ''false'', set <a>is2D</a> of the current matrix to ''false''.</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>translateSelf(<var>tx</var>, <var>ty</var>, <var>tz</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Post-multiply a translation transformation on the current matrix. The 3D translation matrix is <a href="http://www.w3.org/TR/2012/WD-css3-transforms-20120911/#Translate3dDefined">described</a> in CSS Transforms [[!CSS3-TRANSFORMS]].</p>
      <li>If <em>tz</em> is specified and not ''0'', set <a>is2D</a> of the current matrix to ''false''.</p>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>scaleSelf(<var>scale</var>, <var>originX</var>, <var>originY</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Apply a <a method>translateSelf(<var>originX</var>, <var>originY</var>)</a> transformation to the current matrix.</li>
      <li>Post-multiply a uniform 2D scale transformation (<a attribute>m11</a> = <a attribute>m22</a> = <em>scale</em>) on the current matrix. The 2D scale matrix is <a href="http://www.w3.org/TR/2012/WD-css3-transforms-20120911/#ScaleDefined">described</a> in CSS Transforms with <em>sx</em> = <em>sy</em> = <em>scale</em>. [[!CSS3-TRANSFORMS]].</li>
      <li>Apply a <a method>translateSelf(-<var>originX</var>, -<var>originY</var>)</a> transformation to the current matrix.</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>scale3dSelf(<var>scale</var>, <var>originX</var>, <var>originY</var>, <var>originZ</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Apply a <a method>translateSelf(<var>originX</var>, <var>originY</var>, <var>originZ</var>)</a> transformation to the current matrix.</li>
      <li>Post-multiply a uniform 3D scale transformation (<a attribute>m11</a> = <a attribute>m22</a> = <a attribute>m33</a> = <em>scale</em>) on the current matrix. The 3D scale matrix is <a href="http://www.w3.org/TR/2012/WD-css3-transforms-20120911/#Scale3dDefined">described</a> in CSS Transforms with <em>sx</em> = <em>sy</em> = <em>sz</em> = <em>scale</em>. [[!CSS3-TRANSFORMS]].</li>
      <li>Apply a <a method>translateSelf(-<var>originX</var>, -<var>originY</var>, -<var>originZ</var>)</a> transformation to the current matrix.</li>
      <li>If <em>scale</em> is not ''1'', set <a>is2D</a> of the current matrix to ''false''.</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>scaleNonUniformSelf(<var>scaleX</var>, <var>scaleY</var>, <var>scaleZ</var>, <var>originX</var>, <var>originY</var>, <var>originZ</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Apply a <a method>translateSelf(<var>originX</var>, <var>originY</var>, <var>originZ</var>)</a> transformation to the current matrix.</li>
      <li>Post-multiply a non-uniform scale transformation on the current matrix. The 3D scale matrix is <a href="http://www.w3.org/TR/2012/WD-css3-transforms-20120911/#Scale3dDefined">described</a> in CSS Transforms with <em>sx</em> = <em>scaleX</em>,  <em>sy</em> = <em>scaleY</em> and <em>sz</em> = <em>scaleZ</em>. [[!CSS3-TRANSFORMS]].</li>
      <li>Apply a <a method>translateSelf(-<var>originX</var>, -<var>originY</var>, -<var>originZ</var>)</a> transformation to the current matrix.</li>
      <li>If <em>scaleZ</em> is specified and not ''1'' or <em>originZ</em> is specified and not ''0'', set <a>is2D</a> of the current matrix to ''false''.</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>rotateSelf(<var>angle</var>, <var>originX</var>, <var>originY</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Apply a <a method>translateSelf(<var>originX</var>, <var>originY</var>)</a> transformation to the current matrix.</li>
      <li>Post-multiply a rotation transformation on the current matrix with the specified rotation <em>angle</em> in degrees. The 2D rotation matrix is <a href="http://www.w3.org/TR/2012/WD-css3-transforms-20120911/#RotateDefined">described</a> in CSS Transforms with <em>alpha</em> = <em>angle</em> in degrees. [[!CSS3-TRANSFORMS]].</li>
      <li>Apply a <a method>translateSelf(-<var>originX</var>, -<var>originY</var>)</a> transformation to the current matrix.</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>rotateFromVectorSelf(<var>x</var>, <var>y</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Post-multiply a rotation transformation on the current matrix. The rotation angle is determined by the angle between the vector (1,0)<sup>T</sup> and (<em>x</em>,<em>y</em>)<sup>T</sup> in the clockwise direction. If <em>x</em> and <em>y</em> should both be zero, the angle is specified as zero. The 2D rotation matrix is <a href="http://www.w3.org/TR/2012/WD-css3-transforms-20120911/#RotateDefined">described</a> in CSS Transforms where <code>alpha</code> is the angle between the vector (1,0)<sup>T</sup> and (<em>x</em>,<em>y</em>)<sup>T</sup> in degrees [[!CSS3-TRANSFORMS]].</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>rotateAxisAngleSelf(<var>x</var>, <var>y</var>, <var>z</var>, <var>angle</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Post-multiply a rotation transformation on the current matrix around the specified vector <em>x</em>, <em>y</em>, <em>z</em> by the specified rotation <em>angle</em> in degrees. The 3D rotation matrix is <a href="http://www.w3.org/TR/2012/WD-css3-transforms-20120911/#Rotate3dDefined">described</a> in CSS Transforms with <em>alpha</em> = <em>angle</em> in degrees [[!CSS3-TRANSFORMS]].</li>
      <li>If <em>z</em> is not ''0'', set <a>is2D</a> of the current matrix to ''false''.</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>skewXSelf(<var>sx</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Post-multiply a skewX transformation on the current matrix by the specified angle <em>sx</em> in degrees. The 2D skewX matrix is <a href="http://www.w3.org/TR/2012/WD-css3-transforms-20120911/#SkewXDefined">described</a> in CSS Transforms with <em>alpha</em> = <em>sx</em> in degrees [[!CSS3-TRANSFORMS]].</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>skewYSelf(<var>sy</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Post-multiply a skewX transformation on the current matrix by the specified angle <em>sy</em> in degrees. The 2D skewY matrix is <a href="http://www.w3.org/TR/2012/WD-css3-transforms-20120911/#SkewYDefined">described</a> in CSS Transforms with <em>beta</em> = <em>sy</em> in degrees [[!CSS3-TRANSFORMS]].</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>invertSelf()</dfn></dt>
  <dd>
    <ol>
      <li>Invert the current matrix.</li>
      <li>If the current matrix is not invertible set all attributes to ''NaN'' and set <a>is2D</a> to ''false''.</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
  <dt><dfn>setMatrixValue(<var>transformList</var>)</dfn></dt>
  <dd>
    <ol>
      <li>Parse <var>transformList</var> by following the syntax description in “<a href=http://www.w3.org/TR/css-transforms-1/#svg-syntax>Syntax of the SVG ‘transform’ attribute</a>” [[!CSS3-TRANSFORMS]] to a <<transform-list>>. If parsing is not successful or any <<transform-function>> has <<length>> values without <a spec='css-values'>absolute length</a> units<!--For WD: <a spec='css-values-3'>absolute length units</a>-->, throw an <a spec=html5>SyntaxError</a> exception.</li>
      <li>Set <a>is2D</a> to ''false'' if the <<transform-list>> consists of any <a href='http://www.w3.org/TR/css-transforms-1/#three-d-transform-functions'>3D Transform functions</a>. Otherwise set <a>is2D</a> to ''true''.</li>
      <li>Transform all <<transform-function>>s to 4x4 matrices by following the “<a href=http://www.w3.org/TR/css-transforms-1/#mathematical-description>Mathematical Description of Transform Functions</a>” [[!CSS3-TRANSFORMS]].</li>
      <li>Post-multiply all matrices from left to right to a combined 4x4 matrix.</li>
      <li>Set the <a attribute>m11</a> to <a attribute>m44</a> attributes to the element values of the 4x4 matrix in column-major order.</li>
      <li>Return the current matrix.</li>
    </ol>
  </dd>
</dl>

<h2 class="no-num" id="changes">Changes since last publication</h2>

The following changes were made since the <a href="http://www.w3.org/TR/2014/WD-geometry-1-20140522/">22 May 2014 First Public Working Draft</a>.

<ul>
  <li>Renamed mutable transformation methods *By to *Self. (E.g. translateBy() got to translateSelf().)</li>
  <li>Renamed invert() to <a>invertSelf()</a>.</li>
  <li>Added <a>setMatrixValue()</a> which takes a transformation list as DOMString.</li>
  <li><a attribute>is2D</a> and <a attribute>isIdentity</a> are read-only attributes now.</li>
  <li><a interface>DOMMatrixReadOnly</a> gets flagged to track 3D transformation and attribute settings for <a attribute>is2D</a>.</li>
  <li><a>invertSelf()</a> and <a>inverse()</a> do not throw exceptions anymore.</li>
</ul>

<h2 class=no-num id='acknowledgments'>Acknowledgments</h2>

The editors would like to thank Robert O’Callahan for contributing to this specification. Many thanks to Dean Jackson for his initial proposal of DOMMatrix. Thanks to Brian Birtles, Benoit Jacob, Cameron McCormack, Kari Pihkala, Adenilson Cavalcanti and Boris Zbarsky for their careful reviews, comments, and corrections.
